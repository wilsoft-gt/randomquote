import { FormArray } from "@angular/forms";
import { VALUE_CHANGED_SYNC, PATCH } from "../const/app.const";
import { isMatched, clone } from './entity.service';
import { ObjectMaker } from '../util/object-maker';
const PROP_ARRAY = "propArray";
export class RxFormArray extends FormArray {
    constructor(arrayObject, controls, validatorOrOpts, asyncValidator, arrayConfig) {
        super(controls, validatorOrOpts, asyncValidator);
        this.arrayObject = arrayObject;
        this.arrayConfig = arrayConfig;
        this._isModified = false;
        this._modified = [];
        this.cloneObject(arrayObject);
    }
    get isModified() {
        return this._isModified;
    }
    push(control) {
        let formGroup = this.root;
        if (this.arrayObject)
            if (control.modelInstance)
                this.arrayObject.push(control.modelInstance);
        super.push(control);
        if (formGroup[VALUE_CHANGED_SYNC])
            formGroup.valueChangedSync();
        this.patch();
        this.checkValidation();
    }
    patch() {
        this.checkModification();
        if (this.parent)
            this.parent[PATCH]();
    }
    resetForm(options) {
        if (options && options.index >= 0 && options.groupOption) {
            this.controls[options.index].resetForm(options.groupOption);
        }
        else {
            for (var i = 0; i < this._baseValue.length; i++) {
                if (this.controls[i] !== undefined)
                    this.controls[i].resetForm({ value: this._baseValue[i] });
                else if (options && options.pushFunction) {
                    let formGroup = options.pushFunction(this._baseValue[i]);
                    this.push(formGroup);
                }
            }
        }
    }
    commit() {
        this._baseValue = [];
        for (let formGroup of this.controls) {
            formGroup.commit();
            this._baseValue.push(clone(formGroup.value));
        }
        this.patch();
    }
    removeAt(index) {
        let formGroup = this.root;
        this.arrayObject.splice(index, 1);
        super.removeAt(index);
        if (formGroup[VALUE_CHANGED_SYNC])
            formGroup.valueChangedSync();
        this.patch();
        this.checkValidation();
    }
    checkValidation() {
        setTimeout(() => {
            if (this.arrayConfig != undefined && this.arrayConfig.allowMaxIndex && this.length > this.arrayConfig.allowMaxIndex)
                this.setErrors(ObjectMaker.toJson(PROP_ARRAY, this.arrayConfig, [this.length, this.arrayConfig.allowMaxIndex]));
            else if (this.errors && this.errors[PROP_ARRAY])
                delete this.errors[PROP_ARRAY];
        });
    }
    checkModification() {
        this._isModified = !(this._baseValue.length == this.controls.length);
        if (!this._isModified)
            for (var i = 0; i < this.controls.length; i++) {
                this._isModified = isMatched(this._baseValue[i], this.controls[i].value);
                if (this._isModified)
                    break;
            }
    }
    cloneObject(value) {
        this._baseValue = [];
        for (let row of value) {
            this._baseValue.push(clone(row));
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicngtZm9ybS1hcnJheS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0ByeHdlYi9yZWFjdGl2ZS1mb3JtLXZhbGlkYXRvcnMvIiwic291cmNlcyI6WyJzZXJ2aWNlcy9yeC1mb3JtLWFycmF5LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsS0FBSyxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDL0QsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQTtBQUVuRCxPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sc0JBQXNCLENBQUE7QUFDbEQsTUFBTSxVQUFVLEdBQVcsV0FBVyxDQUFDO0FBQ3ZDLE1BQU0sT0FBTyxXQUFZLFNBQVEsU0FBUztJQUl0QyxZQUFvQixXQUFrQixFQUFFLFFBQVEsRUFBRSxlQUFxQixFQUFFLGNBQW9CLEVBQVUsV0FBd0Q7UUFDM0osS0FBSyxDQUFDLFFBQVEsRUFBRSxlQUFlLEVBQUUsY0FBYyxDQUFDLENBQUM7UUFEakMsZ0JBQVcsR0FBWCxXQUFXLENBQU87UUFBaUUsZ0JBQVcsR0FBWCxXQUFXLENBQTZDO1FBRnZKLGdCQUFXLEdBQVksS0FBSyxDQUFDO1FBQzdCLGNBQVMsR0FBVSxFQUFFLENBQUM7UUFHMUIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQsSUFBSSxVQUFVO1FBQ1YsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzVCLENBQUM7SUFFRCxJQUFJLENBQUMsT0FBVztRQUNaLElBQUksU0FBUyxHQUFPLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDOUIsSUFBRyxJQUFJLENBQUMsV0FBVztZQUNmLElBQUcsT0FBTyxDQUFDLGFBQWE7Z0JBQ3BCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxhQUFh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QUFJLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUM7Z0JBQzNDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFFTyxpQkFBaUI7UUFDckIsSUFBSSxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNyRSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVc7WUFDakIsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO2dCQUMzQyxJQUFJLENBQUMsV0FBVyxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUE7Z0JBQ3hFLElBQUksSUFBSSxDQUFDLFdBQVc7b0JBQ2hCLE1BQU07YUFDYjtJQUNULENBQUM7SUFFTyxXQUFXLENBQUMsS0FBWTtRQUM1QixJQUFJLENBQUMsVUFBVSxHQUFHLEVBQUUsQ0FBQztRQUNyQixLQUFLLElBQUksR0FBRyxJQUFJLEtBQUssRUFBRTtZQUNuQixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztTQUNwQztJQUNMLENBQUM7Q0FHSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZvcm1BcnJheSB9IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xyXG5pbXBvcnQgeyBWQUxVRV9DSEFOR0VEX1NZTkMsIFBBVENIIH0gZnJvbSBcIi4uL2NvbnN0L2FwcC5jb25zdFwiO1xyXG5pbXBvcnQgeyBpc01hdGNoZWQsIGNsb25lIH0gZnJvbSAnLi9lbnRpdHkuc2VydmljZSdcclxuaW1wb3J0IHsgUmVzZXRGb3JtVHlwZSB9IGZyb20gXCIuLi9lbnVtcy9yZXNldC10eXBlXCI7XHJcbmltcG9ydCB7IE9iamVjdE1ha2VyIH0gZnJvbSAnLi4vdXRpbC9vYmplY3QtbWFrZXInXHJcbmNvbnN0IFBST1BfQVJSQVk6IHN0cmluZyA9IFwicHJvcEFycmF5XCI7XHJcbmV4cG9ydCBjbGFzcyBSeEZvcm1BcnJheSBleHRlbmRzIEZvcm1BcnJheSB7XHJcbiAgICBwcml2YXRlIF9iYXNlVmFsdWU6IGFueVtdO1xyXG4gICAgcHJpdmF0ZSBfaXNNb2RpZmllZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBfbW9kaWZpZWQ6IGFueVtdID0gW107XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFycmF5T2JqZWN0OiBhbnlbXSwgY29udHJvbHMsIHZhbGlkYXRvck9yT3B0cz86IGFueSwgYXN5bmNWYWxpZGF0b3I/OiBhbnksIHByaXZhdGUgYXJyYXlDb25maWc/OiB7YWxsb3dNYXhJbmRleD86bnVtYmVyLG1lc3NhZ2VLZXk/OnN0cmluZ30pe1xyXG4gICAgICAgIHN1cGVyKGNvbnRyb2xzLCB2YWxpZGF0b3JPck9wdHMsIGFzeW5jVmFsaWRhdG9yKTtcclxuICAgICAgICB0aGlzLmNsb25lT2JqZWN0KGFycmF5T2JqZWN0KTsgICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGdldCBpc01vZGlmaWVkKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc01vZGlmaWVkO1xyXG4gICAgfVxyXG5cclxuICAgIHB1c2goY29udHJvbDphbnkpe1xyXG4gICAgICAgIGxldCBmb3JtR3JvdXA6YW55ID0gdGhpcy5yb290O1xyXG4gICAgICAgIGlmKHRoaXMuYXJyYXlPYmplY3QpXHJcbiAgICAgICAgICAgIGlmKGNvbnRyb2wubW9kZWxJbnN0YW5jZSlcclxuICAgICAgICAgICAgICAgIHRoaXMuYXJyYXlPYmplY3QucHVzaChjb250cm9sLm1vZGVsSW5zdGFuY2UpO1xyXG4gICAgICAgIHN1cGVyLnB1c2goY29udHJvbCk7XHJcbiAgICAgICAgaWYoZm9ybUdyb3VwW1ZBTFVFX0NIQU5HRURfU1lOQ10pXHJcbiAgICAgICAgICAgIGZvcm1Hcm91cC52YWx1ZUNoYW5nZWRTeW5jKClcclxuICAgICAgICB0aGlzLnBhdGNoKClcclxuICAgICAgICB0aGlzLmNoZWNrVmFsaWRhdGlvbigpIFxyXG4gICAgfVxyXG5cclxuICAgIHBhdGNoKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tNb2RpZmljYXRpb24oKTtcclxuICAgICAgICBpZiAodGhpcy5wYXJlbnQpXHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50W1BBVENIXSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXNldEZvcm0ob3B0aW9ucz86IHtcclxuICAgICAgICBpbmRleDogbnVtYmVyLFxyXG4gICAgICAgIGdyb3VwT3B0aW9uOiB7XHJcbiAgICAgICAgICAgIHJlc2V0VHlwZT86IFJlc2V0Rm9ybVR5cGUsXHJcbiAgICAgICAgICAgIHdpdGg/OiBzdHJpbmdbXSxcclxuICAgICAgICAgICAgdmFsdWU/OiB7IFtrZXk6IHN0cmluZ106IGFueSB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBwdXNoRnVuY3Rpb246ICh2YWx1ZTpPYmplY3QpID0+IGJvb2xlYW47XHJcbiAgICB9KSB7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbmRleCA+PSAwICYmIG9wdGlvbnMuZ3JvdXBPcHRpb24pIHtcclxuICAgICAgICAgICAgKDxhbnk+dGhpcy5jb250cm9sc1tvcHRpb25zLmluZGV4XSkucmVzZXRGb3JtKG9wdGlvbnMuZ3JvdXBPcHRpb24pXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9iYXNlVmFsdWUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRyb2xzW2ldICE9PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgKDxhbnk+dGhpcy5jb250cm9sc1tpXSkucmVzZXRGb3JtKHsgdmFsdWU6IHRoaXMuX2Jhc2VWYWx1ZVtpXSB9KTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnB1c2hGdW5jdGlvbilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3JtR3JvdXAgPSBvcHRpb25zLnB1c2hGdW5jdGlvbih0aGlzLl9iYXNlVmFsdWVbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2goZm9ybUdyb3VwKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbiAgICBjb21taXQoKSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVZhbHVlID0gW11cclxuICAgICAgICBmb3IgKGxldCBmb3JtR3JvdXAgb2YgdGhpcy5jb250cm9scykge1xyXG4gICAgICAgICAgICAoPGFueT5mb3JtR3JvdXApLmNvbW1pdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9iYXNlVmFsdWUucHVzaChjbG9uZShmb3JtR3JvdXAudmFsdWUpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wYXRjaCgpO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICByZW1vdmVBdChpbmRleDpudW1iZXIpe1xyXG4gICAgICAgIGxldCBmb3JtR3JvdXA6YW55ID0gdGhpcy5yb290O1xyXG4gICAgICAgIHRoaXMuYXJyYXlPYmplY3Quc3BsaWNlKGluZGV4LDEpO1xyXG4gICAgICAgIHN1cGVyLnJlbW92ZUF0KGluZGV4KTtcclxuICAgICAgICBpZihmb3JtR3JvdXBbVkFMVUVfQ0hBTkdFRF9TWU5DXSlcclxuICAgICAgICAgICAgZm9ybUdyb3VwLnZhbHVlQ2hhbmdlZFN5bmMoKVxyXG4gICAgICAgIHRoaXMucGF0Y2goKVxyXG4gICAgICAgIHRoaXMuY2hlY2tWYWxpZGF0aW9uKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja1ZhbGlkYXRpb24oKSB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFycmF5Q29uZmlnICE9IHVuZGVmaW5lZCAmJiB0aGlzLmFycmF5Q29uZmlnLmFsbG93TWF4SW5kZXggJiYgdGhpcy5sZW5ndGggPiB0aGlzLmFycmF5Q29uZmlnLmFsbG93TWF4SW5kZXgpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldEVycm9ycyhPYmplY3RNYWtlci50b0pzb24oUFJPUF9BUlJBWSwgdGhpcy5hcnJheUNvbmZpZywgW3RoaXMubGVuZ3RoLCB0aGlzLmFycmF5Q29uZmlnLmFsbG93TWF4SW5kZXhdKSk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuZXJyb3JzICYmIHRoaXMuZXJyb3JzW1BST1BfQVJSQVldKVxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZXJyb3JzW1BST1BfQVJSQVldO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjaGVja01vZGlmaWNhdGlvbigpIHtcclxuICAgICAgICB0aGlzLl9pc01vZGlmaWVkID0gISh0aGlzLl9iYXNlVmFsdWUubGVuZ3RoID09IHRoaXMuY29udHJvbHMubGVuZ3RoKTtcclxuICAgICAgICBpZiAoIXRoaXMuX2lzTW9kaWZpZWQpXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jb250cm9scy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faXNNb2RpZmllZCA9IGlzTWF0Y2hlZCh0aGlzLl9iYXNlVmFsdWVbaV0sIHRoaXMuY29udHJvbHNbaV0udmFsdWUpXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNNb2RpZmllZClcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2xvbmVPYmplY3QodmFsdWU6IGFueVtdKSB7XHJcbiAgICAgICAgdGhpcy5fYmFzZVZhbHVlID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgcm93IG9mIHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Jhc2VWYWx1ZS5wdXNoKGNsb25lKHJvdykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG59XHJcbiJdfQ==