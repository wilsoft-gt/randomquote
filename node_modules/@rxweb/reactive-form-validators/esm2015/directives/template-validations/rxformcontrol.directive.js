import * as tslib_1 from "tslib";
import { Directive, Input, ElementRef, forwardRef, Renderer2 } from '@angular/core';
import { NG_VALIDATORS } from '@angular/forms';
import { APP_VALIDATORS } from '../../const/app-validators.const';
import { BaseValidator } from './base-validator.directive';
import { ELEMENT_VALUE, BLUR, FOCUS, BLANK } from "../../const";
import { TEMPLATE_VALIDATION_CONFIG, CONDITIONAL_VALIDATOR, VALIDATOR_CONFIG } from '../../const/app.const';
import { ApplicationUtil } from '../../util/app-util';
import { DecimalProvider } from "../../domain/element-processor/decimal.provider";
import { RegexValidator } from '../../util';
import { MaskProvider } from '../../domain/element-processor/mask.provider';
const NGMODEL_BINDING = {
    provide: NG_VALIDATORS,
    useExisting: forwardRef(() => RxFormControlDirective),
    multi: true
};
const ALLOW_VALIDATOR_WITHOUT_CONFIG = ['required', 'notEmpty', 'alpha', 'alphaNumeric', 'ascii', 'dataUri', 'digit', 'email', 'even', 'hexColor', 'json', 'latitude', 'latLong', 'leapYear', 'longitude', 'lowerCase', 'mac', 'odd', 'port', 'primeNumber', 'time', 'upperCase', 'url', 'unique', 'cusip', 'gird'];
const NUMERIC = "numeric";
const IS_FORMAT = "isFormat";
const DIGITS_INFO = "digitsInfo";
let RxFormControlDirective = class RxFormControlDirective extends BaseValidator {
    constructor(elementRef, renderer, decimalProvider) {
        super();
        this.elementRef = elementRef;
        this.renderer = renderer;
        this.decimalProvider = decimalProvider;
        this.eventListeners = [];
        this.isNumericSubscribed = false;
        this.isFocusCalled = false;
        this.isMasked = false;
        this.element = elementRef.nativeElement;
        this.setEventName();
    }
    set validationControls(value) {
        this.controls = value;
    }
    get validationControls() {
        return this.controls;
    }
    ngOnInit() {
        let validators = [];
        Object.keys(APP_VALIDATORS).forEach(validatorName => {
            if ((this[validatorName]) || (ALLOW_VALIDATOR_WITHOUT_CONFIG.indexOf(validatorName) != -1 && this[validatorName] == BLANK)) {
                validators.push(APP_VALIDATORS[validatorName](this[validatorName]));
                if (this.name && !(this.formControlName && this.formControl)) {
                    ApplicationUtil.configureControl(this.controlConfig, this[validatorName], validatorName);
                }
            }
        });
        if (validators.length > 0)
            this.validators = validators;
        if (this.numeric && (this.numeric.isFormat || this.numeric.digitsInfo)) {
            this.bindNumericElementEvent();
        }
    }
    blurEvent() {
        if (!(this.formControl && this.formControl.errors && this.formControl.errors.numeric)) {
            let value = this.decimalProvider.transFormDecimal(this.formControl.value, this.numeric.digitsInfo);
            value = (!this.numeric.isFormat) ? this.decimalProvider.replacer(value) : value;
            this.setValueOnElement(value);
            this.isFocusCalled = false;
        }
    }
    bindNumericElementEvent(config) {
        if (config)
            this.numeric = config;
        let listener = this.renderer.listen(this.element, BLUR, this.blurEvent.bind(this));
        this.eventListeners.push(listener);
        listener = this.renderer.listen(this.element, FOCUS, (event) => {
            this.isFocusCalled = true;
            if (!(this.formControl && this.formControl.errors && this.formControl.errors.numeric) && this.formControl.value != null) {
                let value = this.decimalProvider.replacer(this.element.value);
                this.setValueOnElement(value);
            }
        });
        this.eventListeners.push(listener);
    }
    bindValueChangeEvent() {
        if (this.eventName != BLANK) {
            let listener = this.renderer.listen(this.element, this.eventName, () => {
                Object.keys(this.validationControls).forEach(fieldName => {
                    this.validationControls[fieldName].updateValueAndValidity();
                });
            });
            this.eventListeners.push(listener);
        }
    }
    subscribeNumericFormatter() {
        if (this.formControl[VALIDATOR_CONFIG] && this.formControl[VALIDATOR_CONFIG][NUMERIC] && (this.formControl[VALIDATOR_CONFIG][NUMERIC][IS_FORMAT] || this.formControl[VALIDATOR_CONFIG][NUMERIC][DIGITS_INFO])) {
            if (!this.isNumericSubscribed) {
                this.bindNumericElementEvent(this.formControl[VALIDATOR_CONFIG][NUMERIC]);
                this.isNumericSubscribed = true;
            }
            if (!this.isFocusCalled && RegexValidator.isNotBlank(this.formControl.value)) {
                this.blurEvent();
            }
        }
    }
    subscribeMaskValidator() {
        if (this.formControl[VALIDATOR_CONFIG] && this.formControl[VALIDATOR_CONFIG]["mask"] && !this.isMasked) {
            let config = this.formControl[VALIDATOR_CONFIG]["mask"];
            this.maskProvider = new MaskProvider(this.element, config.mask, this.renderer, this.formControl, config);
            this.isMasked = true;
        }
    }
    setValueOnElement(value) {
        this.renderer.setProperty(this.element, ELEMENT_VALUE, value);
    }
    setTemplateValidators(control) {
        for (let validatorName in control[VALIDATOR_CONFIG]) {
            this[validatorName] = control[VALIDATOR_CONFIG][validatorName];
        }
        delete control[TEMPLATE_VALIDATION_CONFIG];
        delete control[VALIDATOR_CONFIG];
        this.ngOnInit();
    }
    updateOnElementClass(element) {
        var previousClassName = '';
        return function (className) {
            if (previousClassName)
                element.classList.remove(previousClassName);
            if (className)
                element.classList.add(className);
            previousClassName = className;
        };
    }
    setValidatorConfig(control) {
        if (!this.formControl) {
            this.formControl = control;
            let rxFormControl = this.formControl;
            if (rxFormControl.updateOnElementClass)
                rxFormControl.updateOnElementClass = this.updateOnElementClass(this.element);
        }
        this.subscribeMaskValidator();
        this.subscribeNumericFormatter();
        if (control[TEMPLATE_VALIDATION_CONFIG])
            this.setTemplateValidators(control);
        if (control[CONDITIONAL_VALIDATOR]) {
            this.conditionalValidator = control[CONDITIONAL_VALIDATOR];
            delete control[CONDITIONAL_VALIDATOR];
        }
    }
    validate(control) {
        this.setValidatorConfig(control);
        if (this.conditionalValidator)
            this.conditionalValidator(control);
        if (!this.isProcessed)
            this.setModelConfig(control);
        return ((this.validators && this.validators.length > 0) || this.maskProvider) ? this.validation(control) : null;
    }
    ngOnDestroy() {
        this.controls = undefined;
        let eventCount = this.eventListeners.length;
        for (var i = 0; i < eventCount; i++) {
            this.eventListeners[0]();
            this.eventListeners.splice(0, 1);
        }
        this.eventListeners = [];
        if (this.maskProvider)
            this.maskProvider.onDestroy();
    }
};
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "alpha", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "alphaNumeric", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "ascii", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "compare", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "compose", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "contains", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "creditCard", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "dataUri", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "different", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "digit", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "email", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "endsWith", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "even", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "extension", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "factor", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "fileSize", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "greaterThanEqualTo", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "greaterThan", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "hexColor", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "json", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "latitude", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "latLong", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "leapYear", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "lessThan", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "lessThanEqualTo", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "longitude", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "lowerCase", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "mac", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "maxDate", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "maxLength", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "maxNumber", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "minDate", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "minLength", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "minNumber", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "numeric", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "odd", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "password", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "port", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "primeNumber", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "required", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "range", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "rule", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "startsWith", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "time", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "upperCase", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "url", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "unique", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "notEmpty", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "cusip", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "grid", void 0);
tslib_1.__decorate([
    Input(),
    tslib_1.__metadata("design:type", Object)
], RxFormControlDirective.prototype, "date", void 0);
RxFormControlDirective = tslib_1.__decorate([
    Directive({
        selector: '[ngModel],[formControlName],[formControl]',
        providers: [NGMODEL_BINDING],
    }),
    tslib_1.__metadata("design:paramtypes", [ElementRef,
        Renderer2, DecimalProvider])
], RxFormControlDirective);
export { RxFormControlDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnhmb3JtY29udHJvbC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Acnh3ZWIvcmVhY3RpdmUtZm9ybS12YWxpZGF0b3JzLyIsInNvdXJjZXMiOlsiZGlyZWN0aXZlcy90ZW1wbGF0ZS12YWxpZGF0aW9ucy9yeGZvcm1jb250cm9sLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBcUIsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZHLE9BQU8sRUFBYSxhQUFhLEVBQWdDLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEYsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMzRCxPQUFPLEVBQ0YsYUFBYSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUNyQyxNQUFNLGFBQWEsQ0FBQztBQUNyQixPQUFPLEVBQUUsMEJBQTBCLEVBQUMscUJBQXFCLEVBQUMsZ0JBQWdCLEVBQUcsTUFBTSx1QkFBdUIsQ0FBQTtBQUMxRyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGlEQUFpRCxDQUFBO0FBRWpGLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFNUMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDhDQUE4QyxDQUFDO0FBRzVFLE1BQU0sZUFBZSxHQUFRO0lBQ3pCLE9BQU8sRUFBRSxhQUFhO0lBQ3RCLFdBQVcsRUFBRSxVQUFVLENBQUMsR0FBRyxFQUFFLENBQUMsc0JBQXNCLENBQUM7SUFDckQsS0FBSyxFQUFFLElBQUk7Q0FDZCxDQUFDO0FBRUYsTUFBTSw4QkFBOEIsR0FBRyxDQUFDLFVBQVUsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLGNBQWMsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxhQUFhLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFDLE9BQU8sRUFBQyxNQUFNLENBQUMsQ0FBQztBQUNsVCxNQUFNLE9BQU8sR0FBVSxTQUFTLENBQUM7QUFDakMsTUFBTSxTQUFTLEdBQVUsVUFBVSxDQUFDO0FBQ3BDLE1BQU0sV0FBVyxHQUFXLFlBQVksQ0FBQztBQUt6QyxJQUFhLHNCQUFzQixHQUFuQyxNQUFhLHNCQUF1QixTQUFRLGFBQWE7SUFxRXJELFlBQW9CLFVBQXNCLEVBQzlCLFFBQW1CLEVBQVUsZUFBZ0M7UUFDckUsS0FBSyxFQUFFLENBQUM7UUFGUSxlQUFVLEdBQVYsVUFBVSxDQUFZO1FBQzlCLGFBQVEsR0FBUixRQUFRLENBQVc7UUFBVSxvQkFBZSxHQUFmLGVBQWUsQ0FBaUI7UUFyRWpFLG1CQUFjLEdBQVUsRUFBRSxDQUFDO1FBQzNCLHdCQUFtQixHQUFZLEtBQUssQ0FBQztRQUNyQyxrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUMvQixhQUFRLEdBQVksS0FBSyxDQUFDO1FBb0U5QixJQUFJLENBQUMsT0FBTyxHQUFHLFVBQVUsQ0FBQyxhQUFxQixDQUFDO1FBQ2hELElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBbkVELElBQUksa0JBQWtCLENBQUMsS0FBcUM7UUFDeEQsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7SUFDMUIsQ0FBQztJQUVELElBQUksa0JBQWtCO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQztJQUN6QixDQUFDO0lBK0RELFFBQVE7UUFDSixJQUFJLFVBQVUsR0FBRyxFQUFFLENBQUM7UUFDcEIsTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFDaEQsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsOEJBQThCLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxLQUFLLENBQUMsRUFBRTtnQkFDeEgsVUFBVSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDcEUsSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsRUFBRTtvQkFDMUQsZUFBZSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLGFBQWEsQ0FBQyxDQUFDO2lCQUM1RjthQUVKO1FBQ0wsQ0FBQyxDQUFDLENBQUE7UUFDRixJQUFJLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQztZQUNyQixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQTtRQUNoQyxJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3BFLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxDQUFDO1NBQ2xDO0lBRUwsQ0FBQztJQUdELFNBQVM7UUFDTCxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25GLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNuRyxLQUFLLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7WUFDaEYsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlCLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO1NBQzlCO0lBQ0wsQ0FBQztJQUVELHVCQUF1QixDQUFDLE1BQXNCO1FBQzFDLElBQUksTUFBTTtZQUNOLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1FBQzFCLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkYsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUE7UUFDbEMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDM0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7WUFDMUIsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssSUFBSSxJQUFJLEVBQUU7Z0JBQ3JILElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQzlELElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNqQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUE7SUFDdEMsQ0FBQztJQUVELG9CQUFvQjtRQUNoQixJQUFJLElBQUksQ0FBQyxTQUFTLElBQUksS0FBSyxFQUFFO1lBQ3pCLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7Z0JBQ25FLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxFQUFFO29CQUNyRCxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztnQkFDaEUsQ0FBQyxDQUFDLENBQUE7WUFDTixDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3RDO0lBQ0wsQ0FBQztJQUVELHlCQUF5QjtRQUNyQixJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLEVBQUU7WUFDM00sSUFBRyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsRUFBQztnQkFDekIsSUFBSSxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUMxRSxJQUFJLENBQUMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDO2FBQ25DO1lBQ0QsSUFBRyxDQUFDLElBQUksQ0FBQyxhQUFhLElBQUksY0FBYyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFDO2dCQUN4RSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7YUFDcEI7U0FDSjtJQUVMLENBQUM7SUFFRCxzQkFBc0I7UUFDbEIsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNwRyxJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDeEQsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsV0FBMEIsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUN4SCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztTQUN4QjtJQUNMLENBQUM7SUFFTyxpQkFBaUIsQ0FBQyxLQUFVO1FBQ2hDLElBQUksQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsYUFBYSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ2xFLENBQUM7SUFFTyxxQkFBcUIsQ0FBQyxPQUF1QjtRQUNqRCxLQUFJLElBQUksYUFBYSxJQUFJLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUNsRDtZQUNJLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQztTQUNsRTtRQUNELE9BQU8sT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7UUFDM0MsT0FBTyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQTtRQUNoQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUVPLG9CQUFvQixDQUFDLE9BQW9CO1FBQzdDLElBQUksaUJBQWlCLEdBQVcsRUFBRSxDQUFDO1FBQ25DLE9BQU8sVUFBVSxTQUFpQjtZQUM5QixJQUFJLGlCQUFpQjtnQkFDakIsT0FBTyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUNoRCxJQUFJLFNBQVM7Z0JBQ1QsT0FBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUE7WUFDcEMsaUJBQWlCLEdBQUcsU0FBUyxDQUFDO1FBQ2xDLENBQUMsQ0FBQTtJQUNMLENBQUM7SUFFTyxrQkFBa0IsQ0FBQyxPQUF1QjtRQUM5QyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRTtZQUNuQixJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQztZQUMzQixJQUFJLGFBQWEsR0FBRyxJQUFJLENBQUMsV0FBNEIsQ0FBQztZQUN0RCxJQUFJLGFBQWEsQ0FBQyxvQkFBb0I7Z0JBQ2xDLGFBQWEsQ0FBQyxvQkFBb0IsR0FBRyxJQUFJLENBQUMsb0JBQW9CLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3BGO1FBRUQsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7UUFDOUIsSUFBSSxDQUFDLHlCQUF5QixFQUFFLENBQUM7UUFDckMsSUFBRyxPQUFPLENBQUMsMEJBQTBCLENBQUM7WUFDbEMsSUFBSSxDQUFDLHFCQUFxQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3hDLElBQUksT0FBTyxDQUFDLHFCQUFxQixDQUFDLEVBQUU7WUFDaEMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQzNELE9BQU8sT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUM7U0FDekM7SUFFRCxDQUFDO0lBRUQsUUFBUSxDQUFDLE9BQXdCO1FBQzdCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNqQyxJQUFJLElBQUksQ0FBQyxvQkFBb0I7WUFDekIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVztZQUNqQixJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2pDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDcEgsQ0FBQztJQUVELFdBQVc7UUFDUCxJQUFJLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQztRQUMxQixJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQztRQUM1QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ2pDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztZQUN6QixJQUFJLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7U0FDcEM7UUFDRCxJQUFJLENBQUMsY0FBYyxHQUFHLEVBQUUsQ0FBQztRQUN6QixJQUFJLElBQUksQ0FBQyxZQUFZO1lBQ2pCLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDdEMsQ0FBQztDQUNKLENBQUE7QUF6TVk7SUFBUixLQUFLLEVBQUU7O3FEQUFvQjtBQUNuQjtJQUFSLEtBQUssRUFBRTs7NERBQTJCO0FBQzFCO0lBQVIsS0FBSyxFQUFFOztxREFBbUI7QUFDbEI7SUFBUixLQUFLLEVBQUU7O3VEQUF3QjtBQUN2QjtJQUFSLEtBQUssRUFBRTs7dURBQXdCO0FBQ3ZCO0lBQVIsS0FBSyxFQUFFOzt3REFBMEI7QUFDekI7SUFBUixLQUFLLEVBQUU7OzBEQUE4QjtBQUM3QjtJQUFSLEtBQUssRUFBRTs7dURBQXFCO0FBQ3BCO0lBQVIsS0FBSyxFQUFFOzt5REFBNEI7QUFDM0I7SUFBUixLQUFLLEVBQUU7O3FEQUFvQjtBQUNuQjtJQUFSLEtBQUssRUFBRTs7cURBQW9CO0FBQ25CO0lBQVIsS0FBSyxFQUFFOzt3REFBeUI7QUFDeEI7SUFBUixLQUFLLEVBQUU7O29EQUFrQjtBQUNqQjtJQUFSLEtBQUssRUFBRTs7eURBQTRCO0FBQzNCO0lBQVIsS0FBSyxFQUFFOztzREFBc0I7QUFDckI7SUFBUixLQUFLLEVBQUU7O3dEQUFzQjtBQUNyQjtJQUFSLEtBQUssRUFBRTs7a0VBQThDO0FBQzdDO0lBQVIsS0FBSyxFQUFFOzsyREFBdUM7QUFDdEM7SUFBUixLQUFLLEVBQUU7O3dEQUF5QjtBQUN4QjtJQUFSLEtBQUssRUFBRTs7b0RBQXFCO0FBQ3BCO0lBQVIsS0FBSyxFQUFFOzt3REFBc0I7QUFDckI7SUFBUixLQUFLLEVBQUU7O3VEQUFxQjtBQUNwQjtJQUFSLEtBQUssRUFBRTs7d0RBQXNCO0FBQ3JCO0lBQVIsS0FBSyxFQUFFOzt3REFBb0M7QUFDbkM7SUFBUixLQUFLLEVBQUU7OytEQUEyQztBQUMxQztJQUFSLEtBQUssRUFBRTs7eURBQXVCO0FBQ3RCO0lBQVIsS0FBSyxFQUFFOzt5REFBMEI7QUFDekI7SUFBUixLQUFLLEVBQUU7O21EQUFpQjtBQUNoQjtJQUFSLEtBQUssRUFBRTs7dURBQXFCO0FBQ3BCO0lBQVIsS0FBSyxFQUFFOzt5REFBeUI7QUFDeEI7SUFBUixLQUFLLEVBQUU7O3lEQUF5QjtBQUN4QjtJQUFSLEtBQUssRUFBRTs7dURBQXFCO0FBQ3BCO0lBQVIsS0FBSyxFQUFFOzt5REFBeUI7QUFDeEI7SUFBUixLQUFLLEVBQUU7O3lEQUF5QjtBQUN4QjtJQUFSLEtBQUssRUFBRTs7dURBQXdCO0FBQ3ZCO0lBQVIsS0FBSyxFQUFFOzttREFBaUI7QUFDaEI7SUFBUixLQUFLLEVBQUU7O3dEQUEwQjtBQUN6QjtJQUFSLEtBQUssRUFBRTs7b0RBQWtCO0FBQ2pCO0lBQVIsS0FBSyxFQUFFOzsyREFBeUI7QUFDeEI7SUFBUixLQUFLLEVBQUU7O3dEQUEwQjtBQUN6QjtJQUFSLEtBQUssRUFBRTs7cURBQW9CO0FBQ25CO0lBQVIsS0FBSyxFQUFFOztvREFBa0I7QUFDakI7SUFBUixLQUFLLEVBQUU7OzBEQUEyQjtBQUMxQjtJQUFSLEtBQUssRUFBRTs7b0RBQWtCO0FBQ2pCO0lBQVIsS0FBSyxFQUFFOzt5REFBMEI7QUFDekI7SUFBUixLQUFLLEVBQUU7O21EQUFvQjtBQUNuQjtJQUFSLEtBQUssRUFBRTs7c0RBQXNCO0FBQ3JCO0lBQVIsS0FBSyxFQUFFOzt3REFBc0I7QUFDckI7SUFBUixLQUFLLEVBQUU7O3FEQUFtQjtBQUNsQjtJQUFSLEtBQUssRUFBRTs7b0RBQWtCO0FBQ2pCO0lBQVIsS0FBSyxFQUFFOztvREFBaUI7QUFqRWhCLHNCQUFzQjtJQUpsQyxTQUFTLENBQUM7UUFDUCxRQUFRLEVBQUUsMkNBQTJDO1FBQ3JELFNBQVMsRUFBRSxDQUFDLGVBQWUsQ0FBQztLQUMvQixDQUFDOzZDQXNFa0MsVUFBVTtRQUNwQixTQUFTLEVBQTJCLGVBQWU7R0F0RWhFLHNCQUFzQixDQXdObEM7U0F4Tlksc0JBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBJbnB1dCwgRWxlbWVudFJlZiwgZm9yd2FyZFJlZiwgT25Jbml0LCBPbkRlc3Ryb3ksIFJlbmRlcmVyMiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBWYWxpZGF0b3IsIE5HX1ZBTElEQVRPUlMsIEFic3RyYWN0Q29udHJvbCwgRm9ybUNvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IEFQUF9WQUxJREFUT1JTIH0gZnJvbSAnLi4vLi4vY29uc3QvYXBwLXZhbGlkYXRvcnMuY29uc3QnO1xyXG5pbXBvcnQgeyBCYXNlVmFsaWRhdG9yIH0gZnJvbSAnLi9iYXNlLXZhbGlkYXRvci5kaXJlY3RpdmUnO1xyXG5pbXBvcnQge1xyXG4gICAgIEVMRU1FTlRfVkFMVUUsIEJMVVIsIEZPQ1VTLCBCTEFOS1xyXG59IGZyb20gXCIuLi8uLi9jb25zdFwiO1xyXG5pbXBvcnQgeyBURU1QTEFURV9WQUxJREFUSU9OX0NPTkZJRyxDT05ESVRJT05BTF9WQUxJREFUT1IsVkFMSURBVE9SX0NPTkZJRyAgfSBmcm9tICcuLi8uLi9jb25zdC9hcHAuY29uc3QnXHJcbmltcG9ydCB7IEFwcGxpY2F0aW9uVXRpbCB9IGZyb20gJy4uLy4uL3V0aWwvYXBwLXV0aWwnO1xyXG5pbXBvcnQgeyBEZWNpbWFsUHJvdmlkZXIgfSBmcm9tIFwiLi4vLi4vZG9tYWluL2VsZW1lbnQtcHJvY2Vzc29yL2RlY2ltYWwucHJvdmlkZXJcIlxyXG5pbXBvcnQgeyBBbHBoYUNvbmZpZywgQXJyYXlDb25maWcsIEJhc2VDb25maWcsIENob2ljZUNvbmZpZywgQ29tcGFyZUNvbmZpZywgQ29tcG9zZUNvbmZpZywgQ29udGFpbnNDb25maWcsIENyZWRpdENhcmRDb25maWcsIERhdGVDb25maWcsIERlZmF1bHRDb25maWcsIERpZ2l0Q29uZmlnLCBFbWFpbENvbmZpZywgRXh0ZW5zaW9uQ29uZmlnLCBGYWN0b3JDb25maWcsIE1lc3NhZ2VDb25maWcsIE51bWJlckNvbmZpZywgTnVtZXJpY0NvbmZpZywgUGFzc3dvcmRDb25maWcsIFJhbmdlQ29uZmlnLCBSZXF1aXJlZENvbmZpZywgUnVsZUNvbmZpZywgU2l6ZUNvbmZpZywgVGltZUNvbmZpZywgRGlmZmVyZW50Q29uZmlnLCBSZWxhdGlvbmFsT3BlcmF0b3JDb25maWcsIFVuaXF1ZUNvbmZpZyB9IGZyb20gJy4uLy4uL21vZGVscy9jb25maWcnXHJcbmltcG9ydCB7IFJlZ2V4VmFsaWRhdG9yIH0gZnJvbSAnLi4vLi4vdXRpbCc7XHJcbmltcG9ydCB7IFJ4Rm9ybUNvbnRyb2wgfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvZm9ybS1jb250cm9sXCI7XHJcbmltcG9ydCB7IE1hc2tQcm92aWRlciB9IGZyb20gJy4uLy4uL2RvbWFpbi9lbGVtZW50LXByb2Nlc3Nvci9tYXNrLnByb3ZpZGVyJztcclxuXHJcblxyXG5jb25zdCBOR01PREVMX0JJTkRJTkc6IGFueSA9IHtcclxuICAgIHByb3ZpZGU6IE5HX1ZBTElEQVRPUlMsXHJcbiAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBSeEZvcm1Db250cm9sRGlyZWN0aXZlKSxcclxuICAgIG11bHRpOiB0cnVlXHJcbn07XHJcblxyXG5jb25zdCBBTExPV19WQUxJREFUT1JfV0lUSE9VVF9DT05GSUcgPSBbJ3JlcXVpcmVkJywgJ25vdEVtcHR5JywgJ2FscGhhJywgJ2FscGhhTnVtZXJpYycsICdhc2NpaScsICdkYXRhVXJpJywgJ2RpZ2l0JywgJ2VtYWlsJywgJ2V2ZW4nLCAnaGV4Q29sb3InLCAnanNvbicsICdsYXRpdHVkZScsICdsYXRMb25nJywgJ2xlYXBZZWFyJywgJ2xvbmdpdHVkZScsICdsb3dlckNhc2UnLCAnbWFjJywgJ29kZCcsICdwb3J0JywgJ3ByaW1lTnVtYmVyJywgJ3RpbWUnLCAndXBwZXJDYXNlJywgJ3VybCcsICd1bmlxdWUnLCdjdXNpcCcsJ2dpcmQnXTtcclxuY29uc3QgTlVNRVJJQzpzdHJpbmcgPSBcIm51bWVyaWNcIjtcclxuY29uc3QgSVNfRk9STUFUOnN0cmluZyA9IFwiaXNGb3JtYXRcIjtcclxuY29uc3QgRElHSVRTX0lORk86IHN0cmluZyA9IFwiZGlnaXRzSW5mb1wiO1xyXG5ARGlyZWN0aXZlKHtcclxuICAgIHNlbGVjdG9yOiAnW25nTW9kZWxdLFtmb3JtQ29udHJvbE5hbWVdLFtmb3JtQ29udHJvbF0nLFxyXG4gICAgcHJvdmlkZXJzOiBbTkdNT0RFTF9CSU5ESU5HXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIFJ4Rm9ybUNvbnRyb2xEaXJlY3RpdmUgZXh0ZW5kcyBCYXNlVmFsaWRhdG9yIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIFZhbGlkYXRvciB7XHJcbiAgICBwcml2YXRlIGV2ZW50TGlzdGVuZXJzOiBhbnlbXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBpc051bWVyaWNTdWJzY3JpYmVkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIGlzRm9jdXNDYWxsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgaXNNYXNrZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgICBcclxuICAgIHNldCB2YWxpZGF0aW9uQ29udHJvbHModmFsdWU6IHsgW2tleTogc3RyaW5nXTogRm9ybUNvbnRyb2wgfSkge1xyXG4gICAgICAgIHRoaXMuY29udHJvbHMgPSB2YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgdmFsaWRhdGlvbkNvbnRyb2xzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRyb2xzO1xyXG4gICAgfVxyXG5cclxuICAgIEBJbnB1dCgpIGFscGhhOiBBbHBoYUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGFscGhhTnVtZXJpYzogQWxwaGFDb25maWc7XHJcbiAgICBASW5wdXQoKSBhc2NpaTogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGNvbXBhcmU6IENvbXBhcmVDb25maWc7XHJcbiAgICBASW5wdXQoKSBjb21wb3NlOiBDb21wb3NlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgY29udGFpbnM6IENvbnRhaW5zQ29uZmlnO1xyXG4gICAgQElucHV0KCkgY3JlZGl0Q2FyZDogQ3JlZGl0Q2FyZENvbmZpZztcclxuICAgIEBJbnB1dCgpIGRhdGFVcmk6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBkaWZmZXJlbnQ6IERpZmZlcmVudENvbmZpZztcclxuICAgIEBJbnB1dCgpIGRpZ2l0OiBEaWdpdENvbmZpZztcclxuICAgIEBJbnB1dCgpIGVtYWlsOiBFbWFpbENvbmZpZztcclxuICAgIEBJbnB1dCgpIGVuZHNXaXRoOiBEZWZhdWx0Q29uZmlnO1xyXG4gICAgQElucHV0KCkgZXZlbjogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGV4dGVuc2lvbjogRXh0ZW5zaW9uQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZmFjdG9yOiBGYWN0b3JDb25maWc7XHJcbiAgICBASW5wdXQoKSBmaWxlU2l6ZTogU2l6ZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGdyZWF0ZXJUaGFuRXF1YWxUbzogUmVsYXRpb25hbE9wZXJhdG9yQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZ3JlYXRlclRoYW46IFJlbGF0aW9uYWxPcGVyYXRvckNvbmZpZztcclxuICAgIEBJbnB1dCgpIGhleENvbG9yOiBNZXNzYWdlQ29uZmlnO1xyXG4gICAgQElucHV0KCkganNvbjogRGVmYXVsdENvbmZpZztcclxuICAgIEBJbnB1dCgpIGxhdGl0dWRlOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbGF0TG9uZzogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGxlYXBZZWFyOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbGVzc1RoYW46IFJlbGF0aW9uYWxPcGVyYXRvckNvbmZpZztcclxuICAgIEBJbnB1dCgpIGxlc3NUaGFuRXF1YWxUbzogUmVsYXRpb25hbE9wZXJhdG9yQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbG9uZ2l0dWRlOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbG93ZXJDYXNlOiBNZXNzYWdlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbWFjOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbWF4RGF0ZTogRGF0ZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIG1heExlbmd0aDogTnVtYmVyQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbWF4TnVtYmVyOiBOdW1iZXJDb25maWc7XHJcbiAgICBASW5wdXQoKSBtaW5EYXRlOiBEYXRlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbWluTGVuZ3RoOiBOdW1iZXJDb25maWc7XHJcbiAgICBASW5wdXQoKSBtaW5OdW1iZXI6IE51bWJlckNvbmZpZztcclxuICAgIEBJbnB1dCgpIG51bWVyaWM6IE51bWVyaWNDb25maWc7XHJcbiAgICBASW5wdXQoKSBvZGQ6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBwYXNzd29yZDogUGFzc3dvcmRDb25maWc7XHJcbiAgICBASW5wdXQoKSBwb3J0OiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgcHJpbWVOdW1iZXI6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSByZXF1aXJlZDogUmVxdWlyZWRDb25maWc7XHJcbiAgICBASW5wdXQoKSByYW5nZTogUmFuZ2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBydWxlOiBSdWxlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgc3RhcnRzV2l0aDogRGVmYXVsdENvbmZpZztcclxuICAgIEBJbnB1dCgpIHRpbWU6IFRpbWVDb25maWc7XHJcbiAgICBASW5wdXQoKSB1cHBlckNhc2U6IE1lc3NhZ2VDb25maWc7XHJcbiAgICBASW5wdXQoKSB1cmw6IERlZmF1bHRDb25maWc7XHJcbiAgICBASW5wdXQoKSB1bmlxdWU6IFVuaXF1ZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIG5vdEVtcHR5OiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgY3VzaXA6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBncmlkOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZGF0ZTpCYXNlQ29uZmlnO1xyXG5cclxuXHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBkZWNpbWFsUHJvdmlkZXI6IERlY2ltYWxQcm92aWRlcikge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50IGFzIE5vZGU7XHJcbiAgICAgICAgdGhpcy5zZXRFdmVudE5hbWUoKTtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuICAgICAgICBsZXQgdmFsaWRhdG9ycyA9IFtdO1xyXG4gICAgICAgIE9iamVjdC5rZXlzKEFQUF9WQUxJREFUT1JTKS5mb3JFYWNoKHZhbGlkYXRvck5hbWUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoKHRoaXNbdmFsaWRhdG9yTmFtZV0pIHx8IChBTExPV19WQUxJREFUT1JfV0lUSE9VVF9DT05GSUcuaW5kZXhPZih2YWxpZGF0b3JOYW1lKSAhPSAtMSAmJiB0aGlzW3ZhbGlkYXRvck5hbWVdID09IEJMQU5LKSkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWRhdG9ycy5wdXNoKEFQUF9WQUxJREFUT1JTW3ZhbGlkYXRvck5hbWVdKHRoaXNbdmFsaWRhdG9yTmFtZV0pKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm5hbWUgJiYgISh0aGlzLmZvcm1Db250cm9sTmFtZSAmJiB0aGlzLmZvcm1Db250cm9sKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIEFwcGxpY2F0aW9uVXRpbC5jb25maWd1cmVDb250cm9sKHRoaXMuY29udHJvbENvbmZpZywgdGhpc1t2YWxpZGF0b3JOYW1lXSwgdmFsaWRhdG9yTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICBpZiAodmFsaWRhdG9ycy5sZW5ndGggPiAwKVxyXG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRvcnMgPSB2YWxpZGF0b3JzXHJcbiAgICAgICAgaWYgKHRoaXMubnVtZXJpYyAmJiAodGhpcy5udW1lcmljLmlzRm9ybWF0IHx8IHRoaXMubnVtZXJpYy5kaWdpdHNJbmZvKSkge1xyXG4gICAgICAgICAgICB0aGlzLmJpbmROdW1lcmljRWxlbWVudEV2ZW50KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuXHJcbiAgICBibHVyRXZlbnQoKXtcclxuICAgICAgICBpZiAoISh0aGlzLmZvcm1Db250cm9sICYmIHRoaXMuZm9ybUNvbnRyb2wuZXJyb3JzICYmIHRoaXMuZm9ybUNvbnRyb2wuZXJyb3JzLm51bWVyaWMpKSB7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuZGVjaW1hbFByb3ZpZGVyLnRyYW5zRm9ybURlY2ltYWwodGhpcy5mb3JtQ29udHJvbC52YWx1ZSwgdGhpcy5udW1lcmljLmRpZ2l0c0luZm8pO1xyXG4gICAgICAgICAgICB2YWx1ZSA9ICghdGhpcy5udW1lcmljLmlzRm9ybWF0KSA/IHRoaXMuZGVjaW1hbFByb3ZpZGVyLnJlcGxhY2VyKHZhbHVlKSA6IHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnNldFZhbHVlT25FbGVtZW50KHZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy5pc0ZvY3VzQ2FsbGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGJpbmROdW1lcmljRWxlbWVudEV2ZW50KGNvbmZpZz86IE51bWVyaWNDb25maWcpIHtcclxuICAgICAgICBpZiAoY29uZmlnKVxyXG4gICAgICAgICAgICB0aGlzLm51bWVyaWMgPSBjb25maWc7XHJcbiAgICAgICAgbGV0IGxpc3RlbmVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbGVtZW50LCBCTFVSLCB0aGlzLmJsdXJFdmVudC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpXHJcbiAgICAgICAgbGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW1lbnQsIEZPQ1VTLCAoZXZlbnQpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5pc0ZvY3VzQ2FsbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKCEodGhpcy5mb3JtQ29udHJvbCAmJiB0aGlzLmZvcm1Db250cm9sLmVycm9ycyAmJiB0aGlzLmZvcm1Db250cm9sLmVycm9ycy5udW1lcmljKSAmJiB0aGlzLmZvcm1Db250cm9sLnZhbHVlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuZGVjaW1hbFByb3ZpZGVyLnJlcGxhY2VyKHRoaXMuZWxlbWVudC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFZhbHVlT25FbGVtZW50KHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcilcclxuICAgIH1cclxuXHJcbiAgICBiaW5kVmFsdWVDaGFuZ2VFdmVudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5ldmVudE5hbWUgIT0gQkxBTkspIHtcclxuICAgICAgICAgICAgbGV0IGxpc3RlbmVyID0gdGhpcy5yZW5kZXJlci5saXN0ZW4odGhpcy5lbGVtZW50LCB0aGlzLmV2ZW50TmFtZSwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy52YWxpZGF0aW9uQ29udHJvbHMpLmZvckVhY2goZmllbGROYW1lID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbGlkYXRpb25Db250cm9sc1tmaWVsZE5hbWVdLnVwZGF0ZVZhbHVlQW5kVmFsaWRpdHkoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdWJzY3JpYmVOdW1lcmljRm9ybWF0dGVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZvcm1Db250cm9sW1ZBTElEQVRPUl9DT05GSUddICYmIHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bTlVNRVJJQ10gJiYgKHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bTlVNRVJJQ11bSVNfRk9STUFUXSB8fCB0aGlzLmZvcm1Db250cm9sW1ZBTElEQVRPUl9DT05GSUddW05VTUVSSUNdW0RJR0lUU19JTkZPXSkpIHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuaXNOdW1lcmljU3Vic2NyaWJlZCl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmROdW1lcmljRWxlbWVudEV2ZW50KHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bTlVNRVJJQ10pO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pc051bWVyaWNTdWJzY3JpYmVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZighdGhpcy5pc0ZvY3VzQ2FsbGVkICYmIFJlZ2V4VmFsaWRhdG9yLmlzTm90QmxhbmsodGhpcy5mb3JtQ29udHJvbC52YWx1ZSkpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ibHVyRXZlbnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBzdWJzY3JpYmVNYXNrVmFsaWRhdG9yKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmZvcm1Db250cm9sW1ZBTElEQVRPUl9DT05GSUddICYmIHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bXCJtYXNrXCJdICYmICF0aGlzLmlzTWFza2VkKSB7XHJcbiAgICAgICAgICAgIGxldCBjb25maWcgPSB0aGlzLmZvcm1Db250cm9sW1ZBTElEQVRPUl9DT05GSUddW1wibWFza1wiXTtcclxuICAgICAgICAgICAgdGhpcy5tYXNrUHJvdmlkZXIgPSBuZXcgTWFza1Byb3ZpZGVyKHRoaXMuZWxlbWVudCwgY29uZmlnLm1hc2ssIHRoaXMucmVuZGVyZXIsIHRoaXMuZm9ybUNvbnRyb2wgYXMgRm9ybUNvbnRyb2wsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNNYXNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFZhbHVlT25FbGVtZW50KHZhbHVlOiBhbnkpIHtcclxuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFByb3BlcnR5KHRoaXMuZWxlbWVudCwgRUxFTUVOVF9WQUxVRSwgdmFsdWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0VGVtcGxhdGVWYWxpZGF0b3JzKGNvbnRyb2w6QWJzdHJhY3RDb250cm9sKXtcclxuICAgICAgICBmb3IobGV0IHZhbGlkYXRvck5hbWUgaW4gY29udHJvbFtWQUxJREFUT1JfQ09ORklHXSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXNbdmFsaWRhdG9yTmFtZV0gPSBjb250cm9sW1ZBTElEQVRPUl9DT05GSUddW3ZhbGlkYXRvck5hbWVdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkZWxldGUgY29udHJvbFtURU1QTEFURV9WQUxJREFUSU9OX0NPTkZJR107XHJcbiAgICAgICAgZGVsZXRlIGNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11cclxuICAgICAgICB0aGlzLm5nT25Jbml0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB1cGRhdGVPbkVsZW1lbnRDbGFzcyhlbGVtZW50OiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIHZhciBwcmV2aW91c0NsYXNzTmFtZTogc3RyaW5nID0gJyc7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjbGFzc05hbWU6IHN0cmluZykge1xyXG4gICAgICAgICAgICBpZiAocHJldmlvdXNDbGFzc05hbWUpXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUocHJldmlvdXNDbGFzc05hbWUpO1xyXG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lKVxyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTmFtZSlcclxuICAgICAgICAgICAgcHJldmlvdXNDbGFzc05hbWUgPSBjbGFzc05hbWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIHNldFZhbGlkYXRvckNvbmZpZyhjb250cm9sOkFic3RyYWN0Q29udHJvbCl7XHJcbiAgICAgICAgaWYgKCF0aGlzLmZvcm1Db250cm9sKSB7IFxyXG4gICAgICAgICAgICB0aGlzLmZvcm1Db250cm9sID0gY29udHJvbDtcclxuICAgICAgICAgICAgbGV0IHJ4Rm9ybUNvbnRyb2wgPSB0aGlzLmZvcm1Db250cm9sIGFzIFJ4Rm9ybUNvbnRyb2w7XHJcbiAgICAgICAgICAgIGlmIChyeEZvcm1Db250cm9sLnVwZGF0ZU9uRWxlbWVudENsYXNzKVxyXG4gICAgICAgICAgICAgICAgcnhGb3JtQ29udHJvbC51cGRhdGVPbkVsZW1lbnRDbGFzcyA9IHRoaXMudXBkYXRlT25FbGVtZW50Q2xhc3ModGhpcy5lbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVNYXNrVmFsaWRhdG9yKCk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVOdW1lcmljRm9ybWF0dGVyKCk7XHJcbiAgICBpZihjb250cm9sW1RFTVBMQVRFX1ZBTElEQVRJT05fQ09ORklHXSlcclxuICAgICAgICB0aGlzLnNldFRlbXBsYXRlVmFsaWRhdG9ycyhjb250cm9sKTtcclxuICAgIGlmIChjb250cm9sW0NPTkRJVElPTkFMX1ZBTElEQVRPUl0pIHtcclxuICAgICAgICB0aGlzLmNvbmRpdGlvbmFsVmFsaWRhdG9yID0gY29udHJvbFtDT05ESVRJT05BTF9WQUxJREFUT1JdO1xyXG4gICAgICAgIGRlbGV0ZSBjb250cm9sW0NPTkRJVElPTkFMX1ZBTElEQVRPUl07XHJcbiAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHZhbGlkYXRlKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IHsgW2tleTogc3RyaW5nXTogYW55IH0ge1xyXG4gICAgICAgIHRoaXMuc2V0VmFsaWRhdG9yQ29uZmlnKGNvbnRyb2wpO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbmRpdGlvbmFsVmFsaWRhdG9yKVxyXG4gICAgICAgICAgICB0aGlzLmNvbmRpdGlvbmFsVmFsaWRhdG9yKGNvbnRyb2wpO1xyXG4gICAgICAgIGlmICghdGhpcy5pc1Byb2Nlc3NlZClcclxuICAgICAgICAgICAgdGhpcy5zZXRNb2RlbENvbmZpZyhjb250cm9sKTtcclxuICAgICAgICByZXR1cm4gKCh0aGlzLnZhbGlkYXRvcnMgJiYgdGhpcy52YWxpZGF0b3JzLmxlbmd0aCA+IDApIHx8IHRoaXMubWFza1Byb3ZpZGVyKSA/IHRoaXMudmFsaWRhdGlvbihjb250cm9sKSA6IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgbmdPbkRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5jb250cm9scyA9IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgZXZlbnRDb3VudCA9IHRoaXMuZXZlbnRMaXN0ZW5lcnMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnNbMF0oKTtcclxuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5zcGxpY2UoMCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMgPSBbXTtcclxuICAgICAgICBpZiAodGhpcy5tYXNrUHJvdmlkZXIpXHJcbiAgICAgICAgICAgIHRoaXMubWFza1Byb3ZpZGVyLm9uRGVzdHJveSgpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==