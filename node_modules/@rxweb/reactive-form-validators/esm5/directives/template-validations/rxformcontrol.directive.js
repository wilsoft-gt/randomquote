import * as tslib_1 from "tslib";
import { Directive, Input, ElementRef, forwardRef, Renderer2 } from '@angular/core';
import { NG_VALIDATORS } from '@angular/forms';
import { APP_VALIDATORS } from '../../const/app-validators.const';
import { BaseValidator } from './base-validator.directive';
import { ELEMENT_VALUE, BLUR, FOCUS, BLANK } from "../../const";
import { TEMPLATE_VALIDATION_CONFIG, CONDITIONAL_VALIDATOR, VALIDATOR_CONFIG } from '../../const/app.const';
import { ApplicationUtil } from '../../util/app-util';
import { DecimalProvider } from "../../domain/element-processor/decimal.provider";
import { RegexValidator } from '../../util';
import { MaskProvider } from '../../domain/element-processor/mask.provider';
var NGMODEL_BINDING = {
    provide: NG_VALIDATORS,
    useExisting: forwardRef(function () { return RxFormControlDirective; }),
    multi: true
};
var ALLOW_VALIDATOR_WITHOUT_CONFIG = ['required', 'notEmpty', 'alpha', 'alphaNumeric', 'ascii', 'dataUri', 'digit', 'email', 'even', 'hexColor', 'json', 'latitude', 'latLong', 'leapYear', 'longitude', 'lowerCase', 'mac', 'odd', 'port', 'primeNumber', 'time', 'upperCase', 'url', 'unique', 'cusip', 'gird'];
var NUMERIC = "numeric";
var IS_FORMAT = "isFormat";
var DIGITS_INFO = "digitsInfo";
var RxFormControlDirective = /** @class */ (function (_super) {
    tslib_1.__extends(RxFormControlDirective, _super);
    function RxFormControlDirective(elementRef, renderer, decimalProvider) {
        var _this = _super.call(this) || this;
        _this.elementRef = elementRef;
        _this.renderer = renderer;
        _this.decimalProvider = decimalProvider;
        _this.eventListeners = [];
        _this.isNumericSubscribed = false;
        _this.isFocusCalled = false;
        _this.isMasked = false;
        _this.element = elementRef.nativeElement;
        _this.setEventName();
        return _this;
    }
    Object.defineProperty(RxFormControlDirective.prototype, "validationControls", {
        get: function () {
            return this.controls;
        },
        set: function (value) {
            this.controls = value;
        },
        enumerable: true,
        configurable: true
    });
    RxFormControlDirective.prototype.ngOnInit = function () {
        var _this = this;
        var validators = [];
        Object.keys(APP_VALIDATORS).forEach(function (validatorName) {
            if ((_this[validatorName]) || (ALLOW_VALIDATOR_WITHOUT_CONFIG.indexOf(validatorName) != -1 && _this[validatorName] == BLANK)) {
                validators.push(APP_VALIDATORS[validatorName](_this[validatorName]));
                if (_this.name && !(_this.formControlName && _this.formControl)) {
                    ApplicationUtil.configureControl(_this.controlConfig, _this[validatorName], validatorName);
                }
            }
        });
        if (validators.length > 0)
            this.validators = validators;
        if (this.numeric && (this.numeric.isFormat || this.numeric.digitsInfo)) {
            this.bindNumericElementEvent();
        }
    };
    RxFormControlDirective.prototype.blurEvent = function () {
        if (!(this.formControl && this.formControl.errors && this.formControl.errors.numeric)) {
            var value = this.decimalProvider.transFormDecimal(this.formControl.value, this.numeric.digitsInfo);
            value = (!this.numeric.isFormat) ? this.decimalProvider.replacer(value) : value;
            this.setValueOnElement(value);
            this.isFocusCalled = false;
        }
    };
    RxFormControlDirective.prototype.bindNumericElementEvent = function (config) {
        var _this = this;
        if (config)
            this.numeric = config;
        var listener = this.renderer.listen(this.element, BLUR, this.blurEvent.bind(this));
        this.eventListeners.push(listener);
        listener = this.renderer.listen(this.element, FOCUS, function (event) {
            _this.isFocusCalled = true;
            if (!(_this.formControl && _this.formControl.errors && _this.formControl.errors.numeric) && _this.formControl.value != null) {
                var value = _this.decimalProvider.replacer(_this.element.value);
                _this.setValueOnElement(value);
            }
        });
        this.eventListeners.push(listener);
    };
    RxFormControlDirective.prototype.bindValueChangeEvent = function () {
        var _this = this;
        if (this.eventName != BLANK) {
            var listener = this.renderer.listen(this.element, this.eventName, function () {
                Object.keys(_this.validationControls).forEach(function (fieldName) {
                    _this.validationControls[fieldName].updateValueAndValidity();
                });
            });
            this.eventListeners.push(listener);
        }
    };
    RxFormControlDirective.prototype.subscribeNumericFormatter = function () {
        if (this.formControl[VALIDATOR_CONFIG] && this.formControl[VALIDATOR_CONFIG][NUMERIC] && (this.formControl[VALIDATOR_CONFIG][NUMERIC][IS_FORMAT] || this.formControl[VALIDATOR_CONFIG][NUMERIC][DIGITS_INFO])) {
            if (!this.isNumericSubscribed) {
                this.bindNumericElementEvent(this.formControl[VALIDATOR_CONFIG][NUMERIC]);
                this.isNumericSubscribed = true;
            }
            if (!this.isFocusCalled && RegexValidator.isNotBlank(this.formControl.value)) {
                this.blurEvent();
            }
        }
    };
    RxFormControlDirective.prototype.subscribeMaskValidator = function () {
        if (this.formControl[VALIDATOR_CONFIG] && this.formControl[VALIDATOR_CONFIG]["mask"] && !this.isMasked) {
            var config = this.formControl[VALIDATOR_CONFIG]["mask"];
            this.maskProvider = new MaskProvider(this.element, config.mask, this.renderer, this.formControl, config);
            this.isMasked = true;
        }
    };
    RxFormControlDirective.prototype.setValueOnElement = function (value) {
        this.renderer.setProperty(this.element, ELEMENT_VALUE, value);
    };
    RxFormControlDirective.prototype.setTemplateValidators = function (control) {
        for (var validatorName in control[VALIDATOR_CONFIG]) {
            this[validatorName] = control[VALIDATOR_CONFIG][validatorName];
        }
        delete control[TEMPLATE_VALIDATION_CONFIG];
        delete control[VALIDATOR_CONFIG];
        this.ngOnInit();
    };
    RxFormControlDirective.prototype.updateOnElementClass = function (element) {
        var previousClassName = '';
        return function (className) {
            if (previousClassName)
                element.classList.remove(previousClassName);
            if (className)
                element.classList.add(className);
            previousClassName = className;
        };
    };
    RxFormControlDirective.prototype.setValidatorConfig = function (control) {
        if (!this.formControl) {
            this.formControl = control;
            var rxFormControl = this.formControl;
            if (rxFormControl.updateOnElementClass)
                rxFormControl.updateOnElementClass = this.updateOnElementClass(this.element);
        }
        this.subscribeMaskValidator();
        this.subscribeNumericFormatter();
        if (control[TEMPLATE_VALIDATION_CONFIG])
            this.setTemplateValidators(control);
        if (control[CONDITIONAL_VALIDATOR]) {
            this.conditionalValidator = control[CONDITIONAL_VALIDATOR];
            delete control[CONDITIONAL_VALIDATOR];
        }
    };
    RxFormControlDirective.prototype.validate = function (control) {
        this.setValidatorConfig(control);
        if (this.conditionalValidator)
            this.conditionalValidator(control);
        if (!this.isProcessed)
            this.setModelConfig(control);
        return ((this.validators && this.validators.length > 0) || this.maskProvider) ? this.validation(control) : null;
    };
    RxFormControlDirective.prototype.ngOnDestroy = function () {
        this.controls = undefined;
        var eventCount = this.eventListeners.length;
        for (var i = 0; i < eventCount; i++) {
            this.eventListeners[0]();
            this.eventListeners.splice(0, 1);
        }
        this.eventListeners = [];
        if (this.maskProvider)
            this.maskProvider.onDestroy();
    };
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "alpha", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "alphaNumeric", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "ascii", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "compare", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "compose", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "contains", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "creditCard", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "dataUri", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "different", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "digit", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "email", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "endsWith", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "even", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "extension", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "factor", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "fileSize", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "greaterThanEqualTo", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "greaterThan", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "hexColor", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "json", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "latitude", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "latLong", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "leapYear", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "lessThan", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "lessThanEqualTo", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "longitude", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "lowerCase", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "mac", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "maxDate", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "maxLength", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "maxNumber", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "minDate", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "minLength", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "minNumber", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "numeric", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "odd", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "password", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "port", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "primeNumber", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "required", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "range", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "rule", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "startsWith", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "time", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "upperCase", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "url", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "unique", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "notEmpty", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "cusip", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "grid", void 0);
    tslib_1.__decorate([
        Input(),
        tslib_1.__metadata("design:type", Object)
    ], RxFormControlDirective.prototype, "date", void 0);
    RxFormControlDirective = tslib_1.__decorate([
        Directive({
            selector: '[ngModel],[formControlName],[formControl]',
            providers: [NGMODEL_BINDING],
        }),
        tslib_1.__metadata("design:paramtypes", [ElementRef,
            Renderer2, DecimalProvider])
    ], RxFormControlDirective);
    return RxFormControlDirective;
}(BaseValidator));
export { RxFormControlDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnhmb3JtY29udHJvbC5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Acnh3ZWIvcmVhY3RpdmUtZm9ybS12YWxpZGF0b3JzLyIsInNvdXJjZXMiOlsiZGlyZWN0aXZlcy90ZW1wbGF0ZS12YWxpZGF0aW9ucy9yeGZvcm1jb250cm9sLmRpcmVjdGl2ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBcUIsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZHLE9BQU8sRUFBYSxhQUFhLEVBQWdDLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEYsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBQ2xFLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMzRCxPQUFPLEVBQ0YsYUFBYSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUNyQyxNQUFNLGFBQWEsQ0FBQztBQUNyQixPQUFPLEVBQUUsMEJBQTBCLEVBQUMscUJBQXFCLEVBQUMsZ0JBQWdCLEVBQUcsTUFBTSx1QkFBdUIsQ0FBQTtBQUMxRyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGlEQUFpRCxDQUFBO0FBRWpGLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFNUMsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLDhDQUE4QyxDQUFDO0FBRzVFLElBQU0sZUFBZSxHQUFRO0lBQ3pCLE9BQU8sRUFBRSxhQUFhO0lBQ3RCLFdBQVcsRUFBRSxVQUFVLENBQUMsY0FBTSxPQUFBLHNCQUFzQixFQUF0QixDQUFzQixDQUFDO0lBQ3JELEtBQUssRUFBRSxJQUFJO0NBQ2QsQ0FBQztBQUVGLElBQU0sOEJBQThCLEdBQUcsQ0FBQyxVQUFVLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBRSxjQUFjLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsYUFBYSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBQyxPQUFPLEVBQUMsTUFBTSxDQUFDLENBQUM7QUFDbFQsSUFBTSxPQUFPLEdBQVUsU0FBUyxDQUFDO0FBQ2pDLElBQU0sU0FBUyxHQUFVLFVBQVUsQ0FBQztBQUNwQyxJQUFNLFdBQVcsR0FBVyxZQUFZLENBQUM7QUFLekM7SUFBNEMsa0RBQWE7SUFxRXJELGdDQUFvQixVQUFzQixFQUM5QixRQUFtQixFQUFVLGVBQWdDO1FBRHpFLFlBRUksaUJBQU8sU0FHVjtRQUxtQixnQkFBVSxHQUFWLFVBQVUsQ0FBWTtRQUM5QixjQUFRLEdBQVIsUUFBUSxDQUFXO1FBQVUscUJBQWUsR0FBZixlQUFlLENBQWlCO1FBckVqRSxvQkFBYyxHQUFVLEVBQUUsQ0FBQztRQUMzQix5QkFBbUIsR0FBWSxLQUFLLENBQUM7UUFDckMsbUJBQWEsR0FBWSxLQUFLLENBQUM7UUFDL0IsY0FBUSxHQUFZLEtBQUssQ0FBQztRQW9FOUIsS0FBSSxDQUFDLE9BQU8sR0FBRyxVQUFVLENBQUMsYUFBcUIsQ0FBQztRQUNoRCxLQUFJLENBQUMsWUFBWSxFQUFFLENBQUM7O0lBQ3hCLENBQUM7SUFuRUQsc0JBQUksc0RBQWtCO2FBSXRCO1lBQ0ksT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ3pCLENBQUM7YUFORCxVQUF1QixLQUFxQztZQUN4RCxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQztRQUMxQixDQUFDOzs7T0FBQTtJQW1FRCx5Q0FBUSxHQUFSO1FBQUEsaUJBaUJDO1FBaEJHLElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQztRQUNwQixNQUFNLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFBLGFBQWE7WUFDN0MsSUFBSSxDQUFDLEtBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsOEJBQThCLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxLQUFLLENBQUMsRUFBRTtnQkFDeEgsVUFBVSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsS0FBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDcEUsSUFBSSxLQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxLQUFJLENBQUMsZUFBZSxJQUFJLEtBQUksQ0FBQyxXQUFXLENBQUMsRUFBRTtvQkFDMUQsZUFBZSxDQUFDLGdCQUFnQixDQUFDLEtBQUksQ0FBQyxhQUFhLEVBQUUsS0FBSSxDQUFDLGFBQWEsQ0FBQyxFQUFFLGFBQWEsQ0FBQyxDQUFDO2lCQUM1RjthQUVKO1FBQ0wsQ0FBQyxDQUFDLENBQUE7UUFDRixJQUFJLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQztZQUNyQixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQTtRQUNoQyxJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3BFLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxDQUFDO1NBQ2xDO0lBRUwsQ0FBQztJQUdELDBDQUFTLEdBQVQ7UUFDSSxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25GLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNuRyxLQUFLLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7WUFDaEYsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlCLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDO1NBQzlCO0lBQ0wsQ0FBQztJQUVELHdEQUF1QixHQUF2QixVQUF3QixNQUFzQjtRQUE5QyxpQkFhQztRQVpHLElBQUksTUFBTTtZQUNOLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1FBQzFCLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDbkYsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUE7UUFDbEMsUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSyxFQUFFLFVBQUMsS0FBSztZQUN2RCxLQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztZQUMxQixJQUFJLENBQUMsQ0FBQyxLQUFJLENBQUMsV0FBVyxJQUFJLEtBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxJQUFJLEtBQUksQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEtBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLElBQUksRUFBRTtnQkFDckgsSUFBSSxLQUFLLEdBQUcsS0FBSSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsS0FBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDOUQsS0FBSSxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ2pDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQTtJQUN0QyxDQUFDO0lBRUQscURBQW9CLEdBQXBCO1FBQUEsaUJBU0M7UUFSRyxJQUFJLElBQUksQ0FBQyxTQUFTLElBQUksS0FBSyxFQUFFO1lBQ3pCLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFDOUQsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQSxTQUFTO29CQUNsRCxLQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztnQkFDaEUsQ0FBQyxDQUFDLENBQUE7WUFDTixDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3RDO0lBQ0wsQ0FBQztJQUVELDBEQUF5QixHQUF6QjtRQUNJLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRTtZQUMzTSxJQUFHLENBQUMsSUFBSSxDQUFDLG1CQUFtQixFQUFDO2dCQUN6QixJQUFJLENBQUMsdUJBQXVCLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQzFFLElBQUksQ0FBQyxtQkFBbUIsR0FBRyxJQUFJLENBQUM7YUFDbkM7WUFDRCxJQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsSUFBSSxjQUFjLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLEVBQUM7Z0JBQ3hFLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQzthQUNwQjtTQUNKO0lBRUwsQ0FBQztJQUVELHVEQUFzQixHQUF0QjtRQUNJLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDcEcsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3hELElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFdBQTBCLEVBQUUsTUFBTSxDQUFDLENBQUM7WUFDeEgsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7U0FDeEI7SUFDTCxDQUFDO0lBRU8sa0RBQWlCLEdBQXpCLFVBQTBCLEtBQVU7UUFDaEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDbEUsQ0FBQztJQUVPLHNEQUFxQixHQUE3QixVQUE4QixPQUF1QjtRQUNqRCxLQUFJLElBQUksYUFBYSxJQUFJLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxFQUNsRDtZQUNJLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQztTQUNsRTtRQUNELE9BQU8sT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7UUFDM0MsT0FBTyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsQ0FBQTtRQUNoQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDcEIsQ0FBQztJQUVPLHFEQUFvQixHQUE1QixVQUE2QixPQUFvQjtRQUM3QyxJQUFJLGlCQUFpQixHQUFXLEVBQUUsQ0FBQztRQUNuQyxPQUFPLFVBQVUsU0FBaUI7WUFDOUIsSUFBSSxpQkFBaUI7Z0JBQ2pCLE9BQU8sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFDaEQsSUFBSSxTQUFTO2dCQUNULE9BQU8sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBO1lBQ3BDLGlCQUFpQixHQUFHLFNBQVMsQ0FBQztRQUNsQyxDQUFDLENBQUE7SUFDTCxDQUFDO0lBRU8sbURBQWtCLEdBQTFCLFVBQTJCLE9BQXVCO1FBQzlDLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ25CLElBQUksQ0FBQyxXQUFXLEdBQUcsT0FBTyxDQUFDO1lBQzNCLElBQUksYUFBYSxHQUFHLElBQUksQ0FBQyxXQUE0QixDQUFDO1lBQ3RELElBQUksYUFBYSxDQUFDLG9CQUFvQjtnQkFDbEMsYUFBYSxDQUFDLG9CQUFvQixHQUFHLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDcEY7UUFFRCxJQUFJLENBQUMsc0JBQXNCLEVBQUUsQ0FBQztRQUM5QixJQUFJLENBQUMseUJBQXlCLEVBQUUsQ0FBQztRQUNyQyxJQUFHLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQztZQUNsQyxJQUFJLENBQUMscUJBQXFCLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDeEMsSUFBSSxPQUFPLENBQUMscUJBQXFCLENBQUMsRUFBRTtZQUNoQyxJQUFJLENBQUMsb0JBQW9CLEdBQUcsT0FBTyxDQUFDLHFCQUFxQixDQUFDLENBQUM7WUFDM0QsT0FBTyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQztTQUN6QztJQUVELENBQUM7SUFFRCx5Q0FBUSxHQUFSLFVBQVMsT0FBd0I7UUFDN0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2pDLElBQUksSUFBSSxDQUFDLG9CQUFvQjtZQUN6QixJQUFJLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdkMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXO1lBQ2pCLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDakMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUNwSCxDQUFDO0lBRUQsNENBQVcsR0FBWDtRQUNJLElBQUksQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO1FBQzFCLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDO1FBQzVDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxVQUFVLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDakMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ3pCLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztTQUNwQztRQUNELElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3pCLElBQUksSUFBSSxDQUFDLFlBQVk7WUFDakIsSUFBSSxDQUFDLFlBQVksQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN0QyxDQUFDO0lBeE1RO1FBQVIsS0FBSyxFQUFFOzt5REFBb0I7SUFDbkI7UUFBUixLQUFLLEVBQUU7O2dFQUEyQjtJQUMxQjtRQUFSLEtBQUssRUFBRTs7eURBQW1CO0lBQ2xCO1FBQVIsS0FBSyxFQUFFOzsyREFBd0I7SUFDdkI7UUFBUixLQUFLLEVBQUU7OzJEQUF3QjtJQUN2QjtRQUFSLEtBQUssRUFBRTs7NERBQTBCO0lBQ3pCO1FBQVIsS0FBSyxFQUFFOzs4REFBOEI7SUFDN0I7UUFBUixLQUFLLEVBQUU7OzJEQUFxQjtJQUNwQjtRQUFSLEtBQUssRUFBRTs7NkRBQTRCO0lBQzNCO1FBQVIsS0FBSyxFQUFFOzt5REFBb0I7SUFDbkI7UUFBUixLQUFLLEVBQUU7O3lEQUFvQjtJQUNuQjtRQUFSLEtBQUssRUFBRTs7NERBQXlCO0lBQ3hCO1FBQVIsS0FBSyxFQUFFOzt3REFBa0I7SUFDakI7UUFBUixLQUFLLEVBQUU7OzZEQUE0QjtJQUMzQjtRQUFSLEtBQUssRUFBRTs7MERBQXNCO0lBQ3JCO1FBQVIsS0FBSyxFQUFFOzs0REFBc0I7SUFDckI7UUFBUixLQUFLLEVBQUU7O3NFQUE4QztJQUM3QztRQUFSLEtBQUssRUFBRTs7K0RBQXVDO0lBQ3RDO1FBQVIsS0FBSyxFQUFFOzs0REFBeUI7SUFDeEI7UUFBUixLQUFLLEVBQUU7O3dEQUFxQjtJQUNwQjtRQUFSLEtBQUssRUFBRTs7NERBQXNCO0lBQ3JCO1FBQVIsS0FBSyxFQUFFOzsyREFBcUI7SUFDcEI7UUFBUixLQUFLLEVBQUU7OzREQUFzQjtJQUNyQjtRQUFSLEtBQUssRUFBRTs7NERBQW9DO0lBQ25DO1FBQVIsS0FBSyxFQUFFOzttRUFBMkM7SUFDMUM7UUFBUixLQUFLLEVBQUU7OzZEQUF1QjtJQUN0QjtRQUFSLEtBQUssRUFBRTs7NkRBQTBCO0lBQ3pCO1FBQVIsS0FBSyxFQUFFOzt1REFBaUI7SUFDaEI7UUFBUixLQUFLLEVBQUU7OzJEQUFxQjtJQUNwQjtRQUFSLEtBQUssRUFBRTs7NkRBQXlCO0lBQ3hCO1FBQVIsS0FBSyxFQUFFOzs2REFBeUI7SUFDeEI7UUFBUixLQUFLLEVBQUU7OzJEQUFxQjtJQUNwQjtRQUFSLEtBQUssRUFBRTs7NkRBQXlCO0lBQ3hCO1FBQVIsS0FBSyxFQUFFOzs2REFBeUI7SUFDeEI7UUFBUixLQUFLLEVBQUU7OzJEQUF3QjtJQUN2QjtRQUFSLEtBQUssRUFBRTs7dURBQWlCO0lBQ2hCO1FBQVIsS0FBSyxFQUFFOzs0REFBMEI7SUFDekI7UUFBUixLQUFLLEVBQUU7O3dEQUFrQjtJQUNqQjtRQUFSLEtBQUssRUFBRTs7K0RBQXlCO0lBQ3hCO1FBQVIsS0FBSyxFQUFFOzs0REFBMEI7SUFDekI7UUFBUixLQUFLLEVBQUU7O3lEQUFvQjtJQUNuQjtRQUFSLEtBQUssRUFBRTs7d0RBQWtCO0lBQ2pCO1FBQVIsS0FBSyxFQUFFOzs4REFBMkI7SUFDMUI7UUFBUixLQUFLLEVBQUU7O3dEQUFrQjtJQUNqQjtRQUFSLEtBQUssRUFBRTs7NkRBQTBCO0lBQ3pCO1FBQVIsS0FBSyxFQUFFOzt1REFBb0I7SUFDbkI7UUFBUixLQUFLLEVBQUU7OzBEQUFzQjtJQUNyQjtRQUFSLEtBQUssRUFBRTs7NERBQXNCO0lBQ3JCO1FBQVIsS0FBSyxFQUFFOzt5REFBbUI7SUFDbEI7UUFBUixLQUFLLEVBQUU7O3dEQUFrQjtJQUNqQjtRQUFSLEtBQUssRUFBRTs7d0RBQWlCO0lBakVoQixzQkFBc0I7UUFKbEMsU0FBUyxDQUFDO1lBQ1AsUUFBUSxFQUFFLDJDQUEyQztZQUNyRCxTQUFTLEVBQUUsQ0FBQyxlQUFlLENBQUM7U0FDL0IsQ0FBQztpREFzRWtDLFVBQVU7WUFDcEIsU0FBUyxFQUEyQixlQUFlO09BdEVoRSxzQkFBc0IsQ0F3TmxDO0lBQUQsNkJBQUM7Q0FBQSxBQXhORCxDQUE0QyxhQUFhLEdBd054RDtTQXhOWSxzQkFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEaXJlY3RpdmUsIElucHV0LCBFbGVtZW50UmVmLCBmb3J3YXJkUmVmLCBPbkluaXQsIE9uRGVzdHJveSwgUmVuZGVyZXIyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFZhbGlkYXRvciwgTkdfVkFMSURBVE9SUywgQWJzdHJhY3RDb250cm9sLCBGb3JtQ29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgQVBQX1ZBTElEQVRPUlMgfSBmcm9tICcuLi8uLi9jb25zdC9hcHAtdmFsaWRhdG9ycy5jb25zdCc7XHJcbmltcG9ydCB7IEJhc2VWYWxpZGF0b3IgfSBmcm9tICcuL2Jhc2UtdmFsaWRhdG9yLmRpcmVjdGl2ZSc7XHJcbmltcG9ydCB7XHJcbiAgICAgRUxFTUVOVF9WQUxVRSwgQkxVUiwgRk9DVVMsIEJMQU5LXHJcbn0gZnJvbSBcIi4uLy4uL2NvbnN0XCI7XHJcbmltcG9ydCB7IFRFTVBMQVRFX1ZBTElEQVRJT05fQ09ORklHLENPTkRJVElPTkFMX1ZBTElEQVRPUixWQUxJREFUT1JfQ09ORklHICB9IGZyb20gJy4uLy4uL2NvbnN0L2FwcC5jb25zdCdcclxuaW1wb3J0IHsgQXBwbGljYXRpb25VdGlsIH0gZnJvbSAnLi4vLi4vdXRpbC9hcHAtdXRpbCc7XHJcbmltcG9ydCB7IERlY2ltYWxQcm92aWRlciB9IGZyb20gXCIuLi8uLi9kb21haW4vZWxlbWVudC1wcm9jZXNzb3IvZGVjaW1hbC5wcm92aWRlclwiXHJcbmltcG9ydCB7IEFscGhhQ29uZmlnLCBBcnJheUNvbmZpZywgQmFzZUNvbmZpZywgQ2hvaWNlQ29uZmlnLCBDb21wYXJlQ29uZmlnLCBDb21wb3NlQ29uZmlnLCBDb250YWluc0NvbmZpZywgQ3JlZGl0Q2FyZENvbmZpZywgRGF0ZUNvbmZpZywgRGVmYXVsdENvbmZpZywgRGlnaXRDb25maWcsIEVtYWlsQ29uZmlnLCBFeHRlbnNpb25Db25maWcsIEZhY3RvckNvbmZpZywgTWVzc2FnZUNvbmZpZywgTnVtYmVyQ29uZmlnLCBOdW1lcmljQ29uZmlnLCBQYXNzd29yZENvbmZpZywgUmFuZ2VDb25maWcsIFJlcXVpcmVkQ29uZmlnLCBSdWxlQ29uZmlnLCBTaXplQ29uZmlnLCBUaW1lQ29uZmlnLCBEaWZmZXJlbnRDb25maWcsIFJlbGF0aW9uYWxPcGVyYXRvckNvbmZpZywgVW5pcXVlQ29uZmlnIH0gZnJvbSAnLi4vLi4vbW9kZWxzL2NvbmZpZydcclxuaW1wb3J0IHsgUmVnZXhWYWxpZGF0b3IgfSBmcm9tICcuLi8uLi91dGlsJztcclxuaW1wb3J0IHsgUnhGb3JtQ29udHJvbCB9IGZyb20gXCIuLi8uLi9zZXJ2aWNlcy9mb3JtLWNvbnRyb2xcIjtcclxuaW1wb3J0IHsgTWFza1Byb3ZpZGVyIH0gZnJvbSAnLi4vLi4vZG9tYWluL2VsZW1lbnQtcHJvY2Vzc29yL21hc2sucHJvdmlkZXInO1xyXG5cclxuXHJcbmNvbnN0IE5HTU9ERUxfQklORElORzogYW55ID0ge1xyXG4gICAgcHJvdmlkZTogTkdfVkFMSURBVE9SUyxcclxuICAgIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFJ4Rm9ybUNvbnRyb2xEaXJlY3RpdmUpLFxyXG4gICAgbXVsdGk6IHRydWVcclxufTtcclxuXHJcbmNvbnN0IEFMTE9XX1ZBTElEQVRPUl9XSVRIT1VUX0NPTkZJRyA9IFsncmVxdWlyZWQnLCAnbm90RW1wdHknLCAnYWxwaGEnLCAnYWxwaGFOdW1lcmljJywgJ2FzY2lpJywgJ2RhdGFVcmknLCAnZGlnaXQnLCAnZW1haWwnLCAnZXZlbicsICdoZXhDb2xvcicsICdqc29uJywgJ2xhdGl0dWRlJywgJ2xhdExvbmcnLCAnbGVhcFllYXInLCAnbG9uZ2l0dWRlJywgJ2xvd2VyQ2FzZScsICdtYWMnLCAnb2RkJywgJ3BvcnQnLCAncHJpbWVOdW1iZXInLCAndGltZScsICd1cHBlckNhc2UnLCAndXJsJywgJ3VuaXF1ZScsJ2N1c2lwJywnZ2lyZCddO1xyXG5jb25zdCBOVU1FUklDOnN0cmluZyA9IFwibnVtZXJpY1wiO1xyXG5jb25zdCBJU19GT1JNQVQ6c3RyaW5nID0gXCJpc0Zvcm1hdFwiO1xyXG5jb25zdCBESUdJVFNfSU5GTzogc3RyaW5nID0gXCJkaWdpdHNJbmZvXCI7XHJcbkBEaXJlY3RpdmUoe1xyXG4gICAgc2VsZWN0b3I6ICdbbmdNb2RlbF0sW2Zvcm1Db250cm9sTmFtZV0sW2Zvcm1Db250cm9sXScsXHJcbiAgICBwcm92aWRlcnM6IFtOR01PREVMX0JJTkRJTkddLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgUnhGb3JtQ29udHJvbERpcmVjdGl2ZSBleHRlbmRzIEJhc2VWYWxpZGF0b3IgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgVmFsaWRhdG9yIHtcclxuICAgIHByaXZhdGUgZXZlbnRMaXN0ZW5lcnM6IGFueVtdID0gW107XHJcbiAgICBwcml2YXRlIGlzTnVtZXJpY1N1YnNjcmliZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgaXNGb2N1c0NhbGxlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBpc01hc2tlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICAgIFxyXG4gICAgc2V0IHZhbGlkYXRpb25Db250cm9scyh2YWx1ZTogeyBba2V5OiBzdHJpbmddOiBGb3JtQ29udHJvbCB9KSB7XHJcbiAgICAgICAgdGhpcy5jb250cm9scyA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB2YWxpZGF0aW9uQ29udHJvbHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29udHJvbHM7XHJcbiAgICB9XHJcblxyXG4gICAgQElucHV0KCkgYWxwaGE6IEFscGhhQ29uZmlnO1xyXG4gICAgQElucHV0KCkgYWxwaGFOdW1lcmljOiBBbHBoYUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGFzY2lpOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgY29tcGFyZTogQ29tcGFyZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGNvbXBvc2U6IENvbXBvc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBjb250YWluczogQ29udGFpbnNDb25maWc7XHJcbiAgICBASW5wdXQoKSBjcmVkaXRDYXJkOiBDcmVkaXRDYXJkQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZGF0YVVyaTogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGRpZmZlcmVudDogRGlmZmVyZW50Q29uZmlnO1xyXG4gICAgQElucHV0KCkgZGlnaXQ6IERpZ2l0Q29uZmlnO1xyXG4gICAgQElucHV0KCkgZW1haWw6IEVtYWlsQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZW5kc1dpdGg6IERlZmF1bHRDb25maWc7XHJcbiAgICBASW5wdXQoKSBldmVuOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZXh0ZW5zaW9uOiBFeHRlbnNpb25Db25maWc7XHJcbiAgICBASW5wdXQoKSBmYWN0b3I6IEZhY3RvckNvbmZpZztcclxuICAgIEBJbnB1dCgpIGZpbGVTaXplOiBTaXplQ29uZmlnO1xyXG4gICAgQElucHV0KCkgZ3JlYXRlclRoYW5FcXVhbFRvOiBSZWxhdGlvbmFsT3BlcmF0b3JDb25maWc7XHJcbiAgICBASW5wdXQoKSBncmVhdGVyVGhhbjogUmVsYXRpb25hbE9wZXJhdG9yQ29uZmlnO1xyXG4gICAgQElucHV0KCkgaGV4Q29sb3I6IE1lc3NhZ2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBqc29uOiBEZWZhdWx0Q29uZmlnO1xyXG4gICAgQElucHV0KCkgbGF0aXR1ZGU6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBsYXRMb25nOiBCYXNlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbGVhcFllYXI6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBsZXNzVGhhbjogUmVsYXRpb25hbE9wZXJhdG9yQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbGVzc1RoYW5FcXVhbFRvOiBSZWxhdGlvbmFsT3BlcmF0b3JDb25maWc7XHJcbiAgICBASW5wdXQoKSBsb25naXR1ZGU6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBsb3dlckNhc2U6IE1lc3NhZ2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBtYWM6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBtYXhEYXRlOiBEYXRlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbWF4TGVuZ3RoOiBOdW1iZXJDb25maWc7XHJcbiAgICBASW5wdXQoKSBtYXhOdW1iZXI6IE51bWJlckNvbmZpZztcclxuICAgIEBJbnB1dCgpIG1pbkRhdGU6IERhdGVDb25maWc7XHJcbiAgICBASW5wdXQoKSBtaW5MZW5ndGg6IE51bWJlckNvbmZpZztcclxuICAgIEBJbnB1dCgpIG1pbk51bWJlcjogTnVtYmVyQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbnVtZXJpYzogTnVtZXJpY0NvbmZpZztcclxuICAgIEBJbnB1dCgpIG9kZDogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIHBhc3N3b3JkOiBQYXNzd29yZENvbmZpZztcclxuICAgIEBJbnB1dCgpIHBvcnQ6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBwcmltZU51bWJlcjogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIHJlcXVpcmVkOiBSZXF1aXJlZENvbmZpZztcclxuICAgIEBJbnB1dCgpIHJhbmdlOiBSYW5nZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIHJ1bGU6IFJ1bGVDb25maWc7XHJcbiAgICBASW5wdXQoKSBzdGFydHNXaXRoOiBEZWZhdWx0Q29uZmlnO1xyXG4gICAgQElucHV0KCkgdGltZTogVGltZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIHVwcGVyQ2FzZTogTWVzc2FnZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIHVybDogRGVmYXVsdENvbmZpZztcclxuICAgIEBJbnB1dCgpIHVuaXF1ZTogVW5pcXVlQ29uZmlnO1xyXG4gICAgQElucHV0KCkgbm90RW1wdHk6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBjdXNpcDogQmFzZUNvbmZpZztcclxuICAgIEBJbnB1dCgpIGdyaWQ6IEJhc2VDb25maWc7XHJcbiAgICBASW5wdXQoKSBkYXRlOkJhc2VDb25maWc7XHJcblxyXG5cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLCBwcml2YXRlIGRlY2ltYWxQcm92aWRlcjogRGVjaW1hbFByb3ZpZGVyKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQgYXMgTm9kZTtcclxuICAgICAgICB0aGlzLnNldEV2ZW50TmFtZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIG5nT25Jbml0KCkge1xyXG4gICAgICAgIGxldCB2YWxpZGF0b3JzID0gW107XHJcbiAgICAgICAgT2JqZWN0LmtleXMoQVBQX1ZBTElEQVRPUlMpLmZvckVhY2godmFsaWRhdG9yTmFtZSA9PiB7XHJcbiAgICAgICAgICAgIGlmICgodGhpc1t2YWxpZGF0b3JOYW1lXSkgfHwgKEFMTE9XX1ZBTElEQVRPUl9XSVRIT1VUX0NPTkZJRy5pbmRleE9mKHZhbGlkYXRvck5hbWUpICE9IC0xICYmIHRoaXNbdmFsaWRhdG9yTmFtZV0gPT0gQkxBTkspKSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZGF0b3JzLnB1c2goQVBQX1ZBTElEQVRPUlNbdmFsaWRhdG9yTmFtZV0odGhpc1t2YWxpZGF0b3JOYW1lXSkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubmFtZSAmJiAhKHRoaXMuZm9ybUNvbnRyb2xOYW1lICYmIHRoaXMuZm9ybUNvbnRyb2wpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQXBwbGljYXRpb25VdGlsLmNvbmZpZ3VyZUNvbnRyb2wodGhpcy5jb250cm9sQ29uZmlnLCB0aGlzW3ZhbGlkYXRvck5hbWVdLCB2YWxpZGF0b3JOYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIGlmICh2YWxpZGF0b3JzLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRhdG9ycyA9IHZhbGlkYXRvcnNcclxuICAgICAgICBpZiAodGhpcy5udW1lcmljICYmICh0aGlzLm51bWVyaWMuaXNGb3JtYXQgfHwgdGhpcy5udW1lcmljLmRpZ2l0c0luZm8pKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmluZE51bWVyaWNFbGVtZW50RXZlbnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGJsdXJFdmVudCgpe1xyXG4gICAgICAgIGlmICghKHRoaXMuZm9ybUNvbnRyb2wgJiYgdGhpcy5mb3JtQ29udHJvbC5lcnJvcnMgJiYgdGhpcy5mb3JtQ29udHJvbC5lcnJvcnMubnVtZXJpYykpIHtcclxuICAgICAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5kZWNpbWFsUHJvdmlkZXIudHJhbnNGb3JtRGVjaW1hbCh0aGlzLmZvcm1Db250cm9sLnZhbHVlLCB0aGlzLm51bWVyaWMuZGlnaXRzSW5mbyk7XHJcbiAgICAgICAgICAgIHZhbHVlID0gKCF0aGlzLm51bWVyaWMuaXNGb3JtYXQpID8gdGhpcy5kZWNpbWFsUHJvdmlkZXIucmVwbGFjZXIodmFsdWUpIDogdmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0VmFsdWVPbkVsZW1lbnQodmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLmlzRm9jdXNDYWxsZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYmluZE51bWVyaWNFbGVtZW50RXZlbnQoY29uZmlnPzogTnVtZXJpY0NvbmZpZykge1xyXG4gICAgICAgIGlmIChjb25maWcpXHJcbiAgICAgICAgICAgIHRoaXMubnVtZXJpYyA9IGNvbmZpZztcclxuICAgICAgICBsZXQgbGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW1lbnQsIEJMVVIsIHRoaXMuYmx1ckV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcilcclxuICAgICAgICBsaXN0ZW5lciA9IHRoaXMucmVuZGVyZXIubGlzdGVuKHRoaXMuZWxlbWVudCwgRk9DVVMsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmlzRm9jdXNDYWxsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoISh0aGlzLmZvcm1Db250cm9sICYmIHRoaXMuZm9ybUNvbnRyb2wuZXJyb3JzICYmIHRoaXMuZm9ybUNvbnRyb2wuZXJyb3JzLm51bWVyaWMpICYmIHRoaXMuZm9ybUNvbnRyb2wudmFsdWUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5kZWNpbWFsUHJvdmlkZXIucmVwbGFjZXIodGhpcy5lbGVtZW50LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VmFsdWVPbkVsZW1lbnQodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycy5wdXNoKGxpc3RlbmVyKVxyXG4gICAgfVxyXG5cclxuICAgIGJpbmRWYWx1ZUNoYW5nZUV2ZW50KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmV2ZW50TmFtZSAhPSBCTEFOSykge1xyXG4gICAgICAgICAgICBsZXQgbGlzdGVuZXIgPSB0aGlzLnJlbmRlcmVyLmxpc3Rlbih0aGlzLmVsZW1lbnQsIHRoaXMuZXZlbnROYW1lLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnZhbGlkYXRpb25Db250cm9scykuZm9yRWFjaChmaWVsZE5hbWUgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsaWRhdGlvbkNvbnRyb2xzW2ZpZWxkTmFtZV0udXBkYXRlVmFsdWVBbmRWYWxpZGl0eSgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmliZU51bWVyaWNGb3JtYXR0ZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR10gJiYgdGhpcy5mb3JtQ29udHJvbFtWQUxJREFUT1JfQ09ORklHXVtOVU1FUklDXSAmJiAodGhpcy5mb3JtQ29udHJvbFtWQUxJREFUT1JfQ09ORklHXVtOVU1FUklDXVtJU19GT1JNQVRdIHx8IHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bTlVNRVJJQ11bRElHSVRTX0lORk9dKSkge1xyXG4gICAgICAgICAgICBpZighdGhpcy5pc051bWVyaWNTdWJzY3JpYmVkKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYmluZE51bWVyaWNFbGVtZW50RXZlbnQodGhpcy5mb3JtQ29udHJvbFtWQUxJREFUT1JfQ09ORklHXVtOVU1FUklDXSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmlzTnVtZXJpY1N1YnNjcmliZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmlzRm9jdXNDYWxsZWQgJiYgUmVnZXhWYWxpZGF0b3IuaXNOb3RCbGFuayh0aGlzLmZvcm1Db250cm9sLnZhbHVlKSl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJsdXJFdmVudCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmliZU1hc2tWYWxpZGF0b3IoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR10gJiYgdGhpcy5mb3JtQ29udHJvbFtWQUxJREFUT1JfQ09ORklHXVtcIm1hc2tcIl0gJiYgIXRoaXMuaXNNYXNrZWQpIHtcclxuICAgICAgICAgICAgbGV0IGNvbmZpZyA9IHRoaXMuZm9ybUNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bXCJtYXNrXCJdO1xyXG4gICAgICAgICAgICB0aGlzLm1hc2tQcm92aWRlciA9IG5ldyBNYXNrUHJvdmlkZXIodGhpcy5lbGVtZW50LCBjb25maWcubWFzaywgdGhpcy5yZW5kZXJlciwgdGhpcy5mb3JtQ29udHJvbCBhcyBGb3JtQ29udHJvbCwgY29uZmlnKTtcclxuICAgICAgICAgICAgdGhpcy5pc01hc2tlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0VmFsdWVPbkVsZW1lbnQodmFsdWU6IGFueSkge1xyXG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy5lbGVtZW50LCBFTEVNRU5UX1ZBTFVFLCB2YWx1ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRUZW1wbGF0ZVZhbGlkYXRvcnMoY29udHJvbDpBYnN0cmFjdENvbnRyb2wpe1xyXG4gICAgICAgIGZvcihsZXQgdmFsaWRhdG9yTmFtZSBpbiBjb250cm9sW1ZBTElEQVRPUl9DT05GSUddKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpc1t2YWxpZGF0b3JOYW1lXSA9IGNvbnRyb2xbVkFMSURBVE9SX0NPTkZJR11bdmFsaWRhdG9yTmFtZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlbGV0ZSBjb250cm9sW1RFTVBMQVRFX1ZBTElEQVRJT05fQ09ORklHXTtcclxuICAgICAgICBkZWxldGUgY29udHJvbFtWQUxJREFUT1JfQ09ORklHXVxyXG4gICAgICAgIHRoaXMubmdPbkluaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZU9uRWxlbWVudENsYXNzKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHByZXZpb3VzQ2xhc3NOYW1lOiBzdHJpbmcgPSAnJztcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNsYXNzTmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgICAgIGlmIChwcmV2aW91c0NsYXNzTmFtZSlcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShwcmV2aW91c0NsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUpXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKVxyXG4gICAgICAgICAgICBwcmV2aW91c0NsYXNzTmFtZSA9IGNsYXNzTmFtZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgc2V0VmFsaWRhdG9yQ29uZmlnKGNvbnRyb2w6QWJzdHJhY3RDb250cm9sKXtcclxuICAgICAgICBpZiAoIXRoaXMuZm9ybUNvbnRyb2wpIHsgXHJcbiAgICAgICAgICAgIHRoaXMuZm9ybUNvbnRyb2wgPSBjb250cm9sO1xyXG4gICAgICAgICAgICBsZXQgcnhGb3JtQ29udHJvbCA9IHRoaXMuZm9ybUNvbnRyb2wgYXMgUnhGb3JtQ29udHJvbDtcclxuICAgICAgICAgICAgaWYgKHJ4Rm9ybUNvbnRyb2wudXBkYXRlT25FbGVtZW50Q2xhc3MpXHJcbiAgICAgICAgICAgICAgICByeEZvcm1Db250cm9sLnVwZGF0ZU9uRWxlbWVudENsYXNzID0gdGhpcy51cGRhdGVPbkVsZW1lbnRDbGFzcyh0aGlzLmVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnN1YnNjcmliZU1hc2tWYWxpZGF0b3IoKTtcclxuICAgICAgICB0aGlzLnN1YnNjcmliZU51bWVyaWNGb3JtYXR0ZXIoKTtcclxuICAgIGlmKGNvbnRyb2xbVEVNUExBVEVfVkFMSURBVElPTl9DT05GSUddKVxyXG4gICAgICAgIHRoaXMuc2V0VGVtcGxhdGVWYWxpZGF0b3JzKGNvbnRyb2wpO1xyXG4gICAgaWYgKGNvbnRyb2xbQ09ORElUSU9OQUxfVkFMSURBVE9SXSkge1xyXG4gICAgICAgIHRoaXMuY29uZGl0aW9uYWxWYWxpZGF0b3IgPSBjb250cm9sW0NPTkRJVElPTkFMX1ZBTElEQVRPUl07XHJcbiAgICAgICAgZGVsZXRlIGNvbnRyb2xbQ09ORElUSU9OQUxfVkFMSURBVE9SXTtcclxuICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGUoY29udHJvbDogQWJzdHJhY3RDb250cm9sKTogeyBba2V5OiBzdHJpbmddOiBhbnkgfSB7XHJcbiAgICAgICAgdGhpcy5zZXRWYWxpZGF0b3JDb25maWcoY29udHJvbCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29uZGl0aW9uYWxWYWxpZGF0b3IpXHJcbiAgICAgICAgICAgIHRoaXMuY29uZGl0aW9uYWxWYWxpZGF0b3IoY29udHJvbCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzUHJvY2Vzc2VkKVxyXG4gICAgICAgICAgICB0aGlzLnNldE1vZGVsQ29uZmlnKGNvbnRyb2wpO1xyXG4gICAgICAgIHJldHVybiAoKHRoaXMudmFsaWRhdG9ycyAmJiB0aGlzLnZhbGlkYXRvcnMubGVuZ3RoID4gMCkgfHwgdGhpcy5tYXNrUHJvdmlkZXIpID8gdGhpcy52YWxpZGF0aW9uKGNvbnRyb2wpIDogbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBuZ09uRGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLmNvbnRyb2xzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGxldCBldmVudENvdW50ID0gdGhpcy5ldmVudExpc3RlbmVycy5sZW5ndGg7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudENvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5ldmVudExpc3RlbmVyc1swXSgpO1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50TGlzdGVuZXJzLnNwbGljZSgwLCAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ldmVudExpc3RlbmVycyA9IFtdO1xyXG4gICAgICAgIGlmICh0aGlzLm1hc2tQcm92aWRlcilcclxuICAgICAgICAgICAgdGhpcy5tYXNrUHJvdmlkZXIub25EZXN0cm95KCk7XHJcbiAgICB9XHJcbn1cclxuIl19